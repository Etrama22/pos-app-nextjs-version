module.exports=[41707,87532,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114),e=a.i(33508);function f({isOpen:a,onClose:f,title:g,children:h,size:i="md"}){return(c.useEffect(()=>{let b=a=>{"Escape"===a.key&&f()};return a&&(document.addEventListener("keydown",b),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",b),document.body.style.overflow="unset"}},[a,f]),a)?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:f}),(0,b.jsxs)("div",{className:(0,d.cn)("relative z-50 w-full mx-4 bg-white rounded-xl shadow-xl",{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl"}[i]),children:[g&&(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-secondary-200",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-secondary-900",children:g}),(0,b.jsx)("button",{onClick:f,className:"p-1 rounded-lg text-secondary-500 hover:text-secondary-700 hover:bg-secondary-100 transition-colors",children:(0,b.jsx)(e.X,{className:"w-5 h-5"})})]}),(0,b.jsx)("div",{className:"p-4",children:h})]})]}):null}a.s(["Modal",()=>f],41707);let g=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>g],87532)},66718,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,type:c,label:e,error:f,helperText:g,...h},i)=>(0,b.jsxs)("div",{className:"w-full",children:[e&&(0,b.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:e}),(0,b.jsx)("input",{type:c,className:(0,d.cn)("flex h-10 w-full rounded-lg border border-secondary-300 bg-white px-3 py-2 text-sm text-secondary-900 placeholder:text-secondary-400","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-secondary-50",f&&"border-red-500 focus:ring-red-500 focus:border-red-500",a),ref:i,...h}),f&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:f}),g&&!f&&(0,b.jsx)("p",{className:"mt-1 text-sm text-secondary-500",children:g})]}));e.displayName="Input",a.s(["Input",()=>e])},91119,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("rounded-xl border border-secondary-200 bg-white shadow-sm",a),...c}));e.displayName="Card";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",a),...c}));f.displayName="CardHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("h3",{ref:e,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight text-secondary-900",a),...c}));g.displayName="CardTitle",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("p",{ref:e,className:(0,d.cn)("text-sm text-secondary-500",a),...c})).displayName="CardDescription";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("p-6 pt-0",a),...c}));h.displayName="CardContent",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{ref:e,className:(0,d.cn)("flex items-center p-6 pt-0",a),...c})).displayName="CardFooter",a.s(["Card",()=>e,"CardContent",()=>h,"CardHeader",()=>f,"CardTitle",()=>g])},86304,a=>{"use strict";var b=a.i(87924),c=a.i(68114);function d({className:a,variant:d="default",...e}){return(0,b.jsx)("span",{className:(0,c.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{default:"bg-secondary-100 text-secondary-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-primary-100 text-primary-800"}[d],a),...e})}a.s(["Badge",()=>d])},81560,a=>{"use strict";let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["Trash2",()=>b],81560)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},72156,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(75003),e=a.i(50944),f=a.i(91119),g=a.i(99570),h=a.i(66718),i=a.i(68114);let j=c.forwardRef(({className:a,label:c,error:d,options:e,...f},g)=>(0,b.jsxs)("div",{className:"w-full",children:[c&&(0,b.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:c}),(0,b.jsx)("select",{className:(0,i.cn)("flex h-10 w-full rounded-lg border border-secondary-300 bg-white px-3 py-2 text-sm text-secondary-900","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500","disabled:cursor-not-allowed disabled:opacity-50 disabled:bg-secondary-50",d&&"border-red-500 focus:ring-red-500 focus:border-red-500",a),ref:g,...f,children:e.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))}),d&&(0,b.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d})]}));j.displayName="Select";var k=a.i(86304),l=a.i(41707),m=a.i(69769);process.env.APP_NAME,parseFloat(process.env.TAX_RATE||"0.11");let n=[{value:"CASH",label:"Tunai"},{value:"DEBIT",label:"Kartu Debit"},{value:"CREDIT",label:"Kartu Kredit"},{value:"QRIS",label:"QRIS"},{value:"TRANSFER",label:"Transfer Bank"}];var o=a.i(87532),p=a.i(38784),q=a.i(81560),r=a.i(15618),s=a.i(70106);let t=(0,s.default)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),u=(0,s.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var v=a.i(83497);function w(){let{data:a,status:s}=(0,d.useSession)(),w=(0,e.useRouter)(),{showToast:x}=(0,m.useToast)(),[y,z]=c.useState([]),[A,B]=c.useState([]),[C,D]=c.useState(""),[E,F]=c.useState(!1),[G,H]=c.useState("CASH"),[I,J]=c.useState(""),[K,L]=c.useState(0),[M,N]=c.useState(!1);c.useEffect(()=>{"unauthenticated"===s&&w.push("/login")},[s,w]),c.useEffect(()=>{O()},[C]);let O=async()=>{try{let a=new URLSearchParams;C&&a.append("search",C);let b=await fetch(`/api/products/active?${a}`);if(b.ok){let a=await b.json();z(a)}}catch(a){console.error("Error fetching products:",a)}},P=(a,b)=>{B(c=>{let d=c.find(b=>b.id===a);return d?b<=0?c.filter(b=>b.id!==a):b>d.stock?(x("warning","Stok tidak mencukupi"),c):c.map(c=>c.id===a?{...c,quantity:b}:c):c})},Q=()=>{B([])},R=A.reduce((a,b)=>a+b.price*b.quantity,0),S=(0,i.calculateTax)(R-K),T=R-K+S,U=I?parseFloat(I)-T:0,V=async()=>{if(0===A.length)return void x("warning","Keranjang masih kosong");if(!I||parseFloat(I)<T)return void x("warning","Jumlah pembayaran kurang");N(!0);try{let a=await fetch("/api/sales",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:A.map(a=>({productId:a.id,quantity:a.quantity,priceAtSale:a.price})),discount:K,tax:S,paymentMethod:G,paymentAmount:parseFloat(I)})});if(a.ok){let b=await a.json();x("success",`Transaksi berhasil! No: ${b.receiptNumber}`),Q(),L(0),J(""),F(!1),O()}else{let b=await a.json();x("error",b.error||"Transaksi gagal")}}catch(a){x("error","Terjadi kesalahan")}finally{N(!1)}};return"loading"===s?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-secondary-600",children:"Loading..."})]})}):(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-secondary-900 mb-2",children:"Point of Sale"}),(0,b.jsx)("p",{className:"text-secondary-600",children:"Kelola transaksi penjualan"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardHeader,{className:"py-0 px-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Search,{className:"w-5 text-gray-400"}),(0,b.jsx)(h.Input,{placeholder:"Cari produk...",value:C,onChange:a=>D(a.target.value),className:"border-0 shadow-none focus:ring-0"})]})})}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:y.map(a=>(0,b.jsx)(f.Card,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{B(b=>{let c=b.find(b=>b.id===a.id);return c?c.quantity>=a.stock?(x("warning","Stok tidak mencukupi"),b):b.map(b=>b.id===a.id?{...b,quantity:b.quantity+1}:b):[...b,{...a,quantity:1}]})},children:(0,b.jsxs)(f.CardContent,{className:"p-4",children:[a.imageUrl?(0,b.jsx)("img",{src:a.imageUrl,alt:a.name,className:"w-full h-32 object-cover rounded-lg mb-3"}):(0,b.jsx)("div",{className:"w-full h-32 bg-secondary-100 rounded-lg mb-3 flex items-center justify-center",children:(0,b.jsx)(v.Package,{className:"w-12 h-12 text-secondary-400"})}),(0,b.jsx)("h3",{className:"font-medium text-sm text-secondary-900 mb-1 line-clamp-2",children:a.name}),(0,b.jsx)("p",{className:"text-primary-600 font-semibold mb-2",children:(0,i.formatCurrency)(a.price)}),(0,b.jsxs)(k.Badge,{variant:a.stock>10?"success":"warning",children:["Stok: ",a.stock]})]})},a.id))}),0===y.length&&(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(o.Search,{className:"w-12 h-12 text-secondary-300 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-secondary-500",children:"Tidak ada produk ditemukan"})]})})]}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(f.Card,{className:"sticky top-4",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.ShoppingCart,{className:"w-5 h-5"}),"Keranjang (",A.length,")"]})}),(0,b.jsxs)(f.CardContent,{className:"space-y-4",children:[(0,b.jsx)("div",{className:"max-h-96 overflow-y-auto space-y-3",children:A.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-secondary-50 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-secondary-900 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-secondary-500",children:(0,i.formatCurrency)(a.price)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>P(a.id,a.quantity-1),className:"p-1 rounded hover:bg-white",children:(0,b.jsx)(t,{className:"w-4 h-4"})}),(0,b.jsx)("span",{className:"w-8 text-center text-sm font-medium",children:a.quantity}),(0,b.jsx)("button",{onClick:()=>P(a.id,a.quantity+1),className:"p-1 rounded hover:bg-white",children:(0,b.jsx)(r.Plus,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void B(a=>a.filter(a=>a.id!==b))},className:"p-1 rounded hover:bg-red-50 text-red-600",children:(0,b.jsx)(q.Trash2,{className:"w-4 h-4"})})]})]},a.id))}),0===A.length&&(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(p.ShoppingCart,{className:"w-12 h-12 text-secondary-300 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-secondary-500",children:"Keranjang kosong"})]}),A.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-secondary-600",children:"Subtotal"}),(0,b.jsx)("span",{className:"font-medium",children:(0,i.formatCurrency)(R)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-secondary-600",children:"Diskon"}),(0,b.jsxs)("span",{className:"font-medium",children:["-",(0,i.formatCurrency)(K)]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-secondary-600",children:"Pajak (11%)"}),(0,b.jsx)("span",{className:"font-medium",children:(0,i.formatCurrency)(S)})]}),(0,b.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsx)("span",{className:"text-primary-600",children:(0,i.formatCurrency)(T)})]})]}),(0,b.jsxs)("div",{className:"space-y-2 flex flex-col",children:[(0,b.jsxs)(g.Button,{variant:"outline",className:"w-full",onClick:()=>F(!0),children:[(0,b.jsx)(u,{className:"w-5 h-5 mr-2"}),"Bayar"]}),(0,b.jsxs)(g.Button,{variant:"outline",className:"w-full",onClick:Q,children:[(0,b.jsx)(q.Trash2,{className:"w-5 h-5 mr-2"}),"Bersihkan"]})]})]})]})]})})]}),(0,b.jsx)(l.Modal,{isOpen:E,onClose:()=>F(!1),title:"Checkout",size:"md",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(h.Input,{label:"Diskon",type:"number",value:K,onChange:a=>L(parseFloat(a.target.value)||0),placeholder:"0"}),(0,b.jsx)(j,{label:"Metode Pembayaran",value:G,onChange:a=>H(a.target.value),options:n.map(a=>({value:a.value,label:a.label}))}),(0,b.jsx)(h.Input,{label:"Jumlah Bayar",type:"number",value:I,onChange:a=>J(a.target.value),placeholder:"0"}),(0,b.jsx)("div",{className:"bg-secondary-50 p-4 rounded-lg space-y-2",children:(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-secondary-600",children:"Total"}),(0,b.jsx)("span",{className:"font-bold text-lg text-primary-600",children:(0,i.formatCurrency)(T)})]})}),I&&parseFloat(I)>=T&&(0,b.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-green-700",children:"Kembalian"}),(0,b.jsx)("span",{className:"font-bold text-green-700",children:(0,i.formatCurrency)(U)})]})}),(0,b.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",onClick:()=>F(!1),disabled:M,children:"Batal"}),(0,b.jsx)(g.Button,{variant:"outline",className:"flex-1",onClick:V,isLoading:M,disabled:M,children:"Proses Pembayaran"})]})]})})]})}a.s(["default",()=>w],72156)}];

//# sourceMappingURL=_2535f0c9._.js.map