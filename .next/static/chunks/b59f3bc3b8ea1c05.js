(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var a=e.i(43476),s=e.i(71645),r=e.i(75157);let t=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-xl border border-secondary-200 bg-white shadow-sm",e),...s}));t.displayName="Card";let l=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let d=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight text-secondary-900",e),...s}));d.displayName="CardTitle",s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-secondary-500",e),...s})).displayName="CardDescription";let c=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent",s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter",e.s(["Card",()=>t,"CardContent",()=>c,"CardHeader",()=>l,"CardTitle",()=>d])},87486,e=>{"use strict";var a=e.i(43476),s=e.i(75157);function r({className:e,variant:r="default",...t}){return(0,a.jsx)("span",{className:(0,s.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",{default:"bg-secondary-100 text-secondary-800",success:"bg-green-100 text-green-800",warning:"bg-yellow-100 text-yellow-800",danger:"bg-red-100 text-red-800",info:"bg-primary-100 text-primary-800"}[r],e),...t})}e.s(["Badge",()=>r])},84774,e=>{"use strict";var a=e.i(43476),s=e.i(71645),r=e.i(75157);let t=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{className:"w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...s})}));t.displayName="Table";let l=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...s}));l.displayName="TableHeader";let d=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...s}));d.displayName="TableBody",s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("tfoot",{ref:t,className:(0,r.cn)("bg-secondary-50 font-medium",e),...s})).displayName="TableFooter";let c=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("tr",{ref:t,className:(0,r.cn)("border-b border-secondary-200 transition-colors hover:bg-secondary-50 data-[state=selected]:bg-secondary-100",e),...s}));c.displayName="TableRow";let i=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-secondary-500 [&:has([role=checkbox])]:pr-0",e),...s}));i.displayName="TableHead";let n=s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle text-secondary-900 [&:has([role=checkbox])]:pr-0",e),...s}));n.displayName="TableCell",s.forwardRef(({className:e,...s},t)=>(0,a.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-secondary-500",e),...s})).displayName="TableCaption",e.s(["Table",()=>t,"TableBody",()=>d,"TableCell",()=>n,"TableHead",()=>i,"TableHeader",()=>l,"TableRow",()=>c])},58644,e=>{"use strict";var a=e.i(43476),s=e.i(71645),r=e.i(17255),t=e.i(18566),l=e.i(15288),d=e.i(19455),c=e.i(84774),i=e.i(87486),n=e.i(73635),o=e.i(75157),x=e.i(58041),m=e.i(75254);let h=(0,m.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),f=(0,m.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),p=(0,m.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function u(){let{data:e,status:m}=(0,r.useSession)(),u=(0,t.useRouter)(),{showToast:b}=(0,n.useToast)(),[j,y]=s.useState([]),[N,g]=s.useState(!1);s.useEffect(()=>{"unauthenticated"===m?u.push("/login"):e?.user?.role!=="ADMIN"&&u.push("/pos")},[m,e,u]),s.useEffect(()=>{w()},[]);let w=async()=>{try{let e=await fetch("/api/backup/list?limit=20");if(e.ok){let a=await e.json();y(a.data)}}catch(e){console.error("Error fetching backups:",e)}},T=async()=>{g(!0);try{let e=await fetch("/api/backup/manual",{method:"POST"});if(e.ok)b("success","Backup berhasil dibuat"),w();else{let a=await e.json();b("error",a.error||"Backup gagal")}}catch(e){b("error","Terjadi kesalahan")}finally{g(!1)}},k=async(e,a)=>{try{let s=await fetch(`/api/backup/download?id=${e}`);if(s.ok){let e=await s.blob(),r=window.URL.createObjectURL(e),t=document.createElement("a");t.href=r,t.download=a,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(r),document.body.removeChild(t),b("success","Backup berhasil diunduh")}else b("error","Gagal mengunduh backup")}catch(e){b("error","Terjadi kesalahan")}},v={DAILY:"Harian",WEEKLY:"Mingguan",MONTHLY:"Bulanan",MANUAL:"Manual"};return"loading"===m?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-secondary-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-secondary-900 mb-2",children:"Backup & Restore"}),(0,a.jsx)("p",{className:"text-secondary-600",children:"Kelola backup database"})]}),(0,a.jsxs)(d.Button,{onClick:T,isLoading:N,children:[(0,a.jsx)(x.Database,{className:"w-4 h-4 mr-2"}),"Backup Sekarang"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(x.Database,{className:"w-5 h-5 text-primary-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-secondary-600",children:"Total Backup"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:j.length})]})]})})}),(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(p,{className:"w-5 h-5 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-secondary-600",children:"Auto Backup"}),(0,a.jsx)("p",{className:"text-xl font-bold",children:"Aktif"})]})]})})}),(0,a.jsx)(l.Card,{children:(0,a.jsx)(l.CardContent,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)(f,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-secondary-600",children:"Backup Terakhir"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:j[0]?(0,o.formatDateTime)(j[0].createdAt):"-"})]})]})})})]}),(0,a.jsxs)(l.Card,{children:[(0,a.jsx)(l.CardHeader,{children:(0,a.jsx)(l.CardTitle,{children:"Riwayat Backup"})}),(0,a.jsxs)(l.CardContent,{children:[(0,a.jsxs)(c.Table,{children:[(0,a.jsx)(c.TableHeader,{children:(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableHead,{children:"File Name"}),(0,a.jsx)(c.TableHead,{children:"Tipe"}),(0,a.jsx)(c.TableHead,{children:"Size"}),(0,a.jsx)(c.TableHead,{children:"Tanggal"}),(0,a.jsx)(c.TableHead,{className:"text-right",children:"Aksi"})]})}),(0,a.jsx)(c.TableBody,{children:j.map(e=>(0,a.jsxs)(c.TableRow,{children:[(0,a.jsx)(c.TableCell,{className:"font-mono text-sm",children:e.fileName}),(0,a.jsx)(c.TableCell,{children:(0,a.jsx)(i.Badge,{variant:"info",children:v[e.type]})}),(0,a.jsx)(c.TableCell,{children:(e=>{if(!e)return"-";let a=e/1024;return a<1024?`${a.toFixed(1)} KB`:`${(a/1024).toFixed(1)} MB`})(e.fileSize)}),(0,a.jsx)(c.TableCell,{children:(0,o.formatDateTime)(e.createdAt)}),(0,a.jsx)(c.TableCell,{className:"text-right",children:(0,a.jsx)(d.Button,{size:"sm",variant:"ghost",onClick:()=>k(e.id,e.fileName),children:(0,a.jsx)(h,{className:"w-4 h-4"})})})]},e.id))})]}),0===j.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(x.Database,{className:"w-12 h-12 text-secondary-300 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-secondary-500",children:"Belum ada backup"})]})]})]})]})}e.s(["default",()=>u],58644)}]);