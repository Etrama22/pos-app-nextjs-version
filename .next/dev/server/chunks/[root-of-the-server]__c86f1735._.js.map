{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n\r\nexport default prisma\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/repository.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\r\nimport { CreateProductDTO, UpdateProductDTO, ProductQueryDTO } from './dto'\r\nimport { Prisma } from '@prisma/client'\r\n\r\nexport class ProductRepository {\r\n  async findAll(query: ProductQueryDTO) {\r\n    const {\r\n      page = 1,\r\n      limit = 10,\r\n      search,\r\n      category,\r\n      isActive,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = query\r\n\r\n    const where: Prisma.ProductWhereInput = {\r\n      ...(search && {\r\n        OR: [\r\n          { name: { contains: search } },\r\n          { description: { contains: search } },\r\n          { barcode: { contains: search } },\r\n        ],\r\n      }),\r\n      ...(category && { category }),\r\n      ...(isActive !== undefined && { isActive }),\r\n    }\r\n\r\n    const [data, total] = await Promise.all([\r\n      prisma.product.findMany({\r\n        where,\r\n        skip: (page - 1) * limit,\r\n        take: limit,\r\n        orderBy: { [sortBy]: sortOrder },\r\n      }),\r\n      prisma.product.count({ where }),\r\n    ])\r\n\r\n    return {\r\n      data,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    }\r\n  }\r\n\r\n  async findById(id: string) {\r\n    return prisma.product.findUnique({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async findByBarcode(barcode: string) {\r\n    return prisma.product.findUnique({\r\n      where: { barcode },\r\n    })\r\n  }\r\n\r\n  async findActiveProducts(search?: string) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { gt: 0 },\r\n        ...(search && {\r\n          OR: [\r\n            { name: { contains: search } },\r\n            { barcode: { contains: search } },\r\n          ],\r\n        }),\r\n      },\r\n      orderBy: { name: 'asc' },\r\n    })\r\n  }\r\n\r\n  async create(data: CreateProductDTO) {\r\n    return prisma.product.create({\r\n      data: {\r\n        name: data.name,\r\n        description: data.description,\r\n        price: data.price,\r\n        stock: data.stock,\r\n        imageUrl: data.imageUrl,\r\n        category: data.category,\r\n        barcode: data.barcode,\r\n        isActive: data.isActive ?? true,\r\n      },\r\n    })\r\n  }\r\n\r\n  async update(id: string, data: UpdateProductDTO) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data,\r\n    })\r\n  }\r\n\r\n  async updateStock(id: string, quantity: number) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data: {\r\n        stock: {\r\n          decrement: quantity,\r\n        },\r\n      },\r\n    })\r\n  }\r\n\r\n  async delete(id: string) {\r\n    return prisma.product.delete({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async getCategories() {\r\n    const products = await prisma.product.findMany({\r\n      select: { category: true },\r\n      distinct: ['category'],\r\n      where: { category: { not: null } },\r\n    })\r\n    return products.map((p) => p.category).filter(Boolean) as string[]\r\n  }\r\n\r\n  async getLowStockProducts(threshold: number = 10) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { lte: threshold },\r\n      },\r\n      orderBy: { stock: 'asc' },\r\n    })\r\n  }\r\n}\r\n\r\nexport const productRepository = new ProductRepository()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/service.ts"],"sourcesContent":["import { productRepository } from './repository'\r\nimport { CreateProductDTO, UpdateProductDTO, ProductQueryDTO } from './dto'\r\n\r\nexport class ProductService {\r\n  async getProducts(query: ProductQueryDTO) {\r\n    return productRepository.findAll(query)\r\n  }\r\n\r\n  async getProductById(id: string) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n    return product\r\n  }\r\n\r\n  async getProductByBarcode(barcode: string) {\r\n    const product = await productRepository.findByBarcode(barcode)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n    return product\r\n  }\r\n\r\n  async getActiveProducts(search?: string) {\r\n    return productRepository.findActiveProducts(search)\r\n  }\r\n\r\n  async createProduct(data: CreateProductDTO) {\r\n    // Check if barcode already exists\r\n    if (data.barcode) {\r\n      const existingProduct = await productRepository.findByBarcode(data.barcode)\r\n      if (existingProduct) {\r\n        throw new Error('Barcode sudah digunakan')\r\n      }\r\n    }\r\n\r\n    return productRepository.create(data)\r\n  }\r\n\r\n  async updateProduct(id: string, data: UpdateProductDTO) {\r\n    // Check if product exists\r\n    const existingProduct = await productRepository.findById(id)\r\n    if (!existingProduct) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    // Check if barcode already exists (excluding current product)\r\n    if (data.barcode && data.barcode !== existingProduct.barcode) {\r\n      const productWithBarcode = await productRepository.findByBarcode(data.barcode)\r\n      if (productWithBarcode) {\r\n        throw new Error('Barcode sudah digunakan')\r\n      }\r\n    }\r\n\r\n    return productRepository.update(id, data)\r\n  }\r\n\r\n  async deleteProduct(id: string) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    return productRepository.delete(id)\r\n  }\r\n\r\n  async getCategories() {\r\n    return productRepository.getCategories()\r\n  }\r\n\r\n  async getLowStockProducts(threshold?: number) {\r\n    return productRepository.getLowStockProducts(threshold)\r\n  }\r\n\r\n  async updateStock(id: string, quantity: number) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    if (product.stock < quantity) {\r\n      throw new Error('Stok tidak mencukupi')\r\n    }\r\n\r\n    return productRepository.updateStock(id, quantity)\r\n  }\r\n}\r\n\r\nexport const productService = new ProductService()\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAGO,MAAM;IACX,MAAM,YAAY,KAAsB,EAAE;QACxC,OAAO,+JAAiB,CAAC,OAAO,CAAC;IACnC;IAEA,MAAM,eAAe,EAAU,EAAE;QAC/B,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,oBAAoB,OAAe,EAAE;QACzC,MAAM,UAAU,MAAM,+JAAiB,CAAC,aAAa,CAAC;QACtD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,kBAAkB,MAAe,EAAE;QACvC,OAAO,+JAAiB,CAAC,kBAAkB,CAAC;IAC9C;IAEA,MAAM,cAAc,IAAsB,EAAE;QAC1C,kCAAkC;QAClC,IAAI,KAAK,OAAO,EAAE;YAChB,MAAM,kBAAkB,MAAM,+JAAiB,CAAC,aAAa,CAAC,KAAK,OAAO;YAC1E,IAAI,iBAAiB;gBACnB,MAAM,IAAI,MAAM;YAClB;QACF;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC;IAClC;IAEA,MAAM,cAAc,EAAU,EAAE,IAAsB,EAAE;QACtD,0BAA0B;QAC1B,MAAM,kBAAkB,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACzD,IAAI,CAAC,iBAAiB;YACpB,MAAM,IAAI,MAAM;QAClB;QAEA,8DAA8D;QAC9D,IAAI,KAAK,OAAO,IAAI,KAAK,OAAO,KAAK,gBAAgB,OAAO,EAAE;YAC5D,MAAM,qBAAqB,MAAM,+JAAiB,CAAC,aAAa,CAAC,KAAK,OAAO;YAC7E,IAAI,oBAAoB;gBACtB,MAAM,IAAI,MAAM;YAClB;QACF;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC,IAAI;IACtC;IAEA,MAAM,cAAc,EAAU,EAAE;QAC9B,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC;IAClC;IAEA,MAAM,gBAAgB;QACpB,OAAO,+JAAiB,CAAC,aAAa;IACxC;IAEA,MAAM,oBAAoB,SAAkB,EAAE;QAC5C,OAAO,+JAAiB,CAAC,mBAAmB,CAAC;IAC/C;IAEA,MAAM,YAAY,EAAU,EAAE,QAAgB,EAAE;QAC9C,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,QAAQ,KAAK,GAAG,UAAU;YAC5B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,+JAAiB,CAAC,WAAW,CAAC,IAAI;IAC3C;AACF;AAEO,MAAM,iBAAiB,IAAI"}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 347, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/index.ts"],"sourcesContent":["export { ProductRepository, productRepository } from './repository'\r\nexport { ProductService, productService } from './service'\r\nexport * from './dto'\r\nexport * from './entity'\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/validations.ts"],"sourcesContent":["import { z } from 'zod'\r\n\r\n// Product Schemas\r\nexport const createProductSchema = z.object({\r\n  name: z.string().min(1, 'Nama produk harus diisi'),\r\n  description: z.string().optional(),\r\n  price: z.number().min(0, 'Harga tidak boleh negatif'),\r\n  stock: z.number().int().min(0, 'Stok tidak boleh negatif'),\r\n  imageUrl: z.string().url().optional().or(z.literal('')),\r\n  category: z.string().optional(),\r\n  barcode: z.string().optional(),\r\n  isActive: z.boolean().default(true),\r\n})\r\n\r\nexport const updateProductSchema = createProductSchema.partial()\r\n\r\nexport type CreateProductInput = z.infer<typeof createProductSchema>\r\nexport type UpdateProductInput = z.infer<typeof updateProductSchema>\r\n\r\n// Sale Schemas\r\nexport const saleItemSchema = z.object({\r\n  productId: z.string().min(1, 'Product ID harus diisi'),\r\n  quantity: z.number().int().min(1, 'Quantity minimal 1'),\r\n  priceAtSale: z.number().min(0, 'Harga tidak boleh negatif'),\r\n})\r\n\r\nexport const createSaleSchema = z.object({\r\n  items: z.array(saleItemSchema).min(1, 'Minimal 1 item'),\r\n  discount: z.number().min(0).default(0),\r\n  tax: z.number().min(0).default(0),\r\n  paymentMethod: z.enum(['CASH', 'DEBIT', 'CREDIT', 'QRIS', 'TRANSFER']),\r\n  paymentAmount: z.number().min(0, 'Jumlah pembayaran harus diisi'),\r\n  notes: z.string().optional(),\r\n})\r\n\r\nexport type CreateSaleInput = z.infer<typeof createSaleSchema>\r\nexport type SaleItemInput = z.infer<typeof saleItemSchema>\r\n\r\n// User Schemas\r\nexport const createUserSchema = z.object({\r\n  name: z.string().min(1, 'Nama harus diisi'),\r\n  email: z.string().email('Email tidak valid'),\r\n  password: z.string().min(6, 'Password minimal 6 karakter'),\r\n  role: z.enum(['ADMIN', 'CASHIER']).default('CASHIER'),\r\n})\r\n\r\nexport const loginSchema = z.object({\r\n  email: z.string().email('Email tidak valid'),\r\n  password: z.string().min(1, 'Password harus diisi'),\r\n})\r\n\r\nexport type CreateUserInput = z.infer<typeof createUserSchema>\r\nexport type LoginInput = z.infer<typeof loginSchema>\r\n\r\n// Backup Schemas\r\nexport const createBackupSchema = z.object({\r\n  type: z.enum(['DAILY', 'WEEKLY', 'MONTHLY', 'MANUAL']),\r\n})\r\n\r\nexport type CreateBackupInput = z.infer<typeof createBackupSchema>\r\n\r\n// Query Schemas\r\nexport const paginationSchema = z.object({\r\n  page: z.coerce.number().int().min(1).default(1),\r\n  limit: z.coerce.number().int().min(1).max(100).default(10),\r\n  search: z.string().optional(),\r\n  sortBy: z.string().optional(),\r\n  sortOrder: z.enum(['asc', 'desc']).default('desc'),\r\n})\r\n\r\nexport const dateRangeSchema = z.object({\r\n  startDate: z.string().optional(),\r\n  endDate: z.string().optional(),\r\n})\r\n\r\nexport type PaginationInput = z.infer<typeof paginationSchema>\r\nexport type DateRangeInput = z.infer<typeof dateRangeSchema>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;AAGO,MAAM,sBAAsB,oLAAC,CAAC,MAAM,CAAC;IAC1C,MAAM,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,aAAa,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAChC,OAAO,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACzB,OAAO,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG;IAC/B,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,EAAE,CAAC,oLAAC,CAAC,OAAO,CAAC;IACnD,UAAU,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,SAAS,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,UAAU,oLAAC,CAAC,OAAO,GAAG,OAAO,CAAC;AAChC;AAEO,MAAM,sBAAsB,oBAAoB,OAAO;AAMvD,MAAM,iBAAiB,oLAAC,CAAC,MAAM,CAAC;IACrC,WAAW,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG;IAClC,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACjC;AAEO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,OAAO,oLAAC,CAAC,KAAK,CAAC,gBAAgB,GAAG,CAAC,GAAG;IACtC,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IACpC,KAAK,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IAC/B,eAAe,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;QAAS;QAAU;QAAQ;KAAW;IACrE,eAAe,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACjC,OAAO,oLAAC,CAAC,MAAM,GAAG,QAAQ;AAC5B;AAMO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,MAAM,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,MAAM,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAS;KAAU,EAAE,OAAO,CAAC;AAC7C;AAEO,MAAM,cAAc,oLAAC,CAAC,MAAM,CAAC;IAClC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAMO,MAAM,qBAAqB,oLAAC,CAAC,MAAM,CAAC;IACzC,MAAM,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAS;QAAU;QAAW;KAAS;AACvD;AAKO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,MAAM,oLAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IAC7C,OAAO,oLAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,KAAK,OAAO,CAAC;IACvD,QAAQ,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,QAAQ,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,WAAW,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAO;KAAO,EAAE,OAAO,CAAC;AAC7C;AAEO,MAAM,kBAAkB,oLAAC,CAAC,MAAM,CAAC;IACtC,WAAW,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC9B,SAAS,oLAAC,CAAC,MAAM,GAAG,QAAQ;AAC9B"}},
    {"offset": {"line": 511, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth'\r\nimport CredentialsProvider from 'next-auth/providers/credentials'\r\nimport { PrismaAdapter } from '@auth/prisma-adapter'\r\nimport prisma from '@/lib/prisma'\r\nimport bcrypt from 'bcryptjs'\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  adapter: PrismaAdapter(prisma) as NextAuthOptions['adapter'],\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        email: { label: 'Email', type: 'email' },\r\n        password: { label: 'Password', type: 'password' },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email || !credentials?.password) {\r\n          throw new Error('Email dan password harus diisi')\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n          where: { email: credentials.email },\r\n        })\r\n\r\n        if (!user) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        const isPasswordValid = await bcrypt.compare(\r\n          credentials.password,\r\n          user.password\r\n        )\r\n\r\n        if (!isPasswordValid) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        return {\r\n          id: user.id,\r\n          email: user.email,\r\n          name: user.name,\r\n          role: user.role,\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n        token.role = user.role\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        session.user.id = token.id as string\r\n        session.user.role = token.role as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n    error: '/login',\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n    maxAge: 24 * 60 * 60, // 24 hours\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS,IAAA,uKAAa,EAAC,iIAAM;IAC7B,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAC;gBACpC;gBAEA,IAAI,CAAC,MAAM;oBACT,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK;IACpB;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC"}},
    {"offset": {"line": 593, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/app/api/products/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { productService } from '@/modules/products'\r\nimport { createProductSchema, updateProductSchema } from '@/lib/validations'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    \r\n    const query = {\r\n      page: parseInt(searchParams.get('page') || '1'),\r\n      limit: parseInt(searchParams.get('limit') || '10'),\r\n      search: searchParams.get('search') || undefined,\r\n      category: searchParams.get('category') || undefined,\r\n      isActive: searchParams.get('isActive') === 'true' ? true : \r\n               searchParams.get('isActive') === 'false' ? false : undefined,\r\n      sortBy: (searchParams.get('sortBy') as 'name' | 'price' | 'stock' | 'createdAt') || 'createdAt',\r\n      sortOrder: (searchParams.get('sortOrder') as 'asc' | 'desc') || 'desc',\r\n    }\r\n\r\n    const result = await productService.getProducts(query)\r\n    return NextResponse.json(result)\r\n  } catch (error) {\r\n    console.error('Error fetching products:', error)\r\n    return NextResponse.json(\r\n      { error: 'Gagal mengambil data produk' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session || session.user.role !== 'ADMIN') {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    const body = await request.json()\r\n    const validatedData = createProductSchema.parse(body)\r\n    \r\n    const product = await productService.createProduct(validatedData)\r\n    return NextResponse.json(product, { status: 201 })\r\n  } catch (error) {\r\n    console.error('Error creating product:', error)\r\n    if (error instanceof Error) {\r\n      return NextResponse.json(\r\n        { error: error.message },\r\n        { status: 400 }\r\n      )\r\n    }\r\n    return NextResponse.json(\r\n      { error: 'Gagal membuat produk' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,MAAM,QAAQ;YACZ,MAAM,SAAS,aAAa,GAAG,CAAC,WAAW;YAC3C,OAAO,SAAS,aAAa,GAAG,CAAC,YAAY;YAC7C,QAAQ,aAAa,GAAG,CAAC,aAAa;YACtC,UAAU,aAAa,GAAG,CAAC,eAAe;YAC1C,UAAU,aAAa,GAAG,CAAC,gBAAgB,SAAS,OAC3C,aAAa,GAAG,CAAC,gBAAgB,UAAU,QAAQ;YAC5D,QAAQ,AAAC,aAAa,GAAG,CAAC,aAA0D;YACpF,WAAW,AAAC,aAAa,GAAG,CAAC,gBAAmC;QAClE;QAEA,MAAM,SAAS,MAAM,yJAAc,CAAC,WAAW,CAAC;QAChD,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA8B,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,mIAAW;QAClD,IAAI,CAAC,WAAW,QAAQ,IAAI,CAAC,IAAI,KAAK,SAAS;YAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,kJAAmB,CAAC,KAAK,CAAC;QAEhD,MAAM,UAAU,MAAM,yJAAc,CAAC,aAAa,CAAC;QACnD,OAAO,gJAAY,CAAC,IAAI,CAAC,SAAS;YAAE,QAAQ;QAAI;IAClD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,IAAI,iBAAiB,OAAO;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,MAAM,OAAO;YAAC,GACvB;gBAAE,QAAQ;YAAI;QAElB;QACA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAuB,GAChC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}