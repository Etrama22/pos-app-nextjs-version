{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n\r\nexport default prisma\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n\r\nexport function formatCurrency(amount: number): string {\r\n  return new Intl.NumberFormat('id-ID', {\r\n    style: 'currency',\r\n    currency: 'IDR',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(amount)\r\n}\r\n\r\nexport function formatDate(date: Date | string): string {\r\n  const d = new Date(date)\r\n  return new Intl.DateTimeFormat('id-ID', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n  }).format(d)\r\n}\r\n\r\nexport function formatDateTime(date: Date | string): string {\r\n  const d = new Date(date)\r\n  return new Intl.DateTimeFormat('id-ID', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(d)\r\n}\r\n\r\nexport function generateReceiptNumber(): string {\r\n  const date = new Date()\r\n  const year = date.getFullYear().toString().slice(-2)\r\n  const month = (date.getMonth() + 1).toString().padStart(2, '0')\r\n  const day = date.getDate().toString().padStart(2, '0')\r\n  const random = Math.random().toString(36).substring(2, 8).toUpperCase()\r\n  return `INV${year}${month}${day}-${random}`\r\n}\r\n\r\nexport function generateBackupFileName(type: string): string {\r\n  const date = new Date()\r\n  const timestamp = date.toISOString().replace(/[:.]/g, '-')\r\n  return `backup_${type}_${timestamp}.json`\r\n}\r\n\r\nexport function calculateTax(subtotal: number, taxRate: number = 0.11): number {\r\n  return Math.round(subtotal * taxRate)\r\n}\r\n\r\nexport function calculateDiscount(subtotal: number, discountPercent: number): number {\r\n  return Math.round(subtotal * (discountPercent / 100))\r\n}\r\n\r\nexport function debounce<T extends (...args: Parameters<T>) => ReturnType<T>>(\r\n  func: T,\r\n  wait: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeout: NodeJS.Timeout | null = null\r\n  return (...args: Parameters<T>) => {\r\n    if (timeout) clearTimeout(timeout)\r\n    timeout = setTimeout(() => func(...args), wait)\r\n  }\r\n}\r\n\r\nexport function truncateText(text: string, maxLength: number): string {\r\n  if (text.length <= maxLength) return text\r\n  return text.slice(0, maxLength) + '...'\r\n}\r\n\r\nexport function getInitials(name: string): string {\r\n  return name\r\n    .split(' ')\r\n    .map((n) => n[0])\r\n    .join('')\r\n    .toUpperCase()\r\n    .slice(0, 2)\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,wKAAO,EAAC,IAAA,+IAAI,EAAC;AACtB;AAEO,SAAS,eAAe,MAAc;IAC3C,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,eAAe,IAAmB;IAChD,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;IACV,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS;IACd,MAAM,OAAO,IAAI;IACjB,MAAM,OAAO,KAAK,WAAW,GAAG,QAAQ,GAAG,KAAK,CAAC,CAAC;IAClD,MAAM,QAAQ,CAAC,KAAK,QAAQ,KAAK,CAAC,EAAE,QAAQ,GAAG,QAAQ,CAAC,GAAG;IAC3D,MAAM,MAAM,KAAK,OAAO,GAAG,QAAQ,GAAG,QAAQ,CAAC,GAAG;IAClD,MAAM,SAAS,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,GAAG,WAAW;IACrE,OAAO,CAAC,GAAG,EAAE,OAAO,QAAQ,IAAI,CAAC,EAAE,QAAQ;AAC7C;AAEO,SAAS,uBAAuB,IAAY;IACjD,MAAM,OAAO,IAAI;IACjB,MAAM,YAAY,KAAK,WAAW,GAAG,OAAO,CAAC,SAAS;IACtD,OAAO,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,UAAU,KAAK,CAAC;AAC3C;AAEO,SAAS,aAAa,QAAgB,EAAE,UAAkB,IAAI;IACnE,OAAO,KAAK,KAAK,CAAC,WAAW;AAC/B;AAEO,SAAS,kBAAkB,QAAgB,EAAE,eAAuB;IACzE,OAAO,KAAK,KAAK,CAAC,WAAW,CAAC,kBAAkB,GAAG;AACrD;AAEO,SAAS,SACd,IAAO,EACP,IAAY;IAEZ,IAAI,UAAiC;IACrC,OAAO,CAAC,GAAG;QACT,IAAI,SAAS,aAAa;QAC1B,UAAU,WAAW,IAAM,QAAQ,OAAO;IAC5C;AACF;AAEO,SAAS,aAAa,IAAY,EAAE,SAAiB;IAC1D,IAAI,KAAK,MAAM,IAAI,WAAW,OAAO;IACrC,OAAO,KAAK,KAAK,CAAC,GAAG,aAAa;AACpC;AAEO,SAAS,YAAY,IAAY;IACtC,OAAO,KACJ,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE,EACf,IAAI,CAAC,IACL,WAAW,GACX,KAAK,CAAC,GAAG;AACd"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/sales/repository.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\r\nimport { CreateSaleDTO, SaleQueryDTO } from './dto'\r\nimport { Prisma, PaymentMethod } from '@prisma/client'\r\nimport { generateReceiptNumber } from '@/lib/utils'\r\n\r\nexport class SaleRepository {\r\n  async findAll(query: SaleQueryDTO) {\r\n    const {\r\n      page = 1,\r\n      limit = 10,\r\n      startDate,\r\n      endDate,\r\n      paymentMethod,\r\n      userId,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = query\r\n\r\n    const where: Prisma.SaleWhereInput = {\r\n      ...(startDate && {\r\n        createdAt: {\r\n          gte: new Date(startDate),\r\n        },\r\n      }),\r\n      ...(endDate && {\r\n        createdAt: {\r\n          ...(startDate && { gte: new Date(startDate) }),\r\n          lte: new Date(endDate),\r\n        },\r\n      }),\r\n      ...(paymentMethod && { paymentMethod }),\r\n      ...(userId && { userId }),\r\n    }\r\n\r\n    const [data, total] = await Promise.all([\r\n      prisma.sale.findMany({\r\n        where,\r\n        include: {\r\n          items: {\r\n            include: {\r\n              product: {\r\n                select: {\r\n                  id: true,\r\n                  name: true,\r\n                  imageUrl: true,\r\n                },\r\n              },\r\n            },\r\n          },\r\n          user: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              email: true,\r\n            },\r\n          },\r\n        },\r\n        skip: (page - 1) * limit,\r\n        take: limit,\r\n        orderBy: { [sortBy]: sortOrder },\r\n      }),\r\n      prisma.sale.count({ where }),\r\n    ])\r\n\r\n    return {\r\n      data,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    }\r\n  }\r\n\r\n  async findById(id: string) {\r\n    return prisma.sale.findUnique({\r\n      where: { id },\r\n      include: {\r\n        items: {\r\n          include: {\r\n            product: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                imageUrl: true,\r\n              },\r\n            },\r\n          },\r\n        },\r\n        user: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n          },\r\n        },\r\n      },\r\n    })\r\n  }\r\n\r\n  async findByReceiptNumber(receiptNumber: string) {\r\n    return prisma.sale.findUnique({\r\n      where: { receiptNumber },\r\n      include: {\r\n        items: {\r\n          include: {\r\n            product: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                imageUrl: true,\r\n              },\r\n            },\r\n          },\r\n        },\r\n        user: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n          },\r\n        },\r\n      },\r\n    })\r\n  }\r\n\r\n  async create(data: CreateSaleDTO) {\r\n    const subtotal = data.items.reduce(\r\n      (sum, item) => sum + item.priceAtSale * item.quantity,\r\n      0\r\n    )\r\n    const discount = data.discount || 0\r\n    const tax = data.tax || 0\r\n    const total = subtotal - discount + tax\r\n    const changeAmount = data.paymentAmount - total\r\n\r\n    return prisma.$transaction(async (tx) => {\r\n      // Create sale\r\n      const sale = await tx.sale.create({\r\n        data: {\r\n          receiptNumber: generateReceiptNumber(),\r\n          subtotal,\r\n          discount,\r\n          tax,\r\n          total,\r\n          paymentMethod: data.paymentMethod,\r\n          paymentAmount: data.paymentAmount,\r\n          changeAmount: changeAmount > 0 ? changeAmount : 0,\r\n          notes: data.notes,\r\n          userId: data.userId,\r\n          items: {\r\n            create: data.items.map((item) => ({\r\n              productId: item.productId,\r\n              quantity: item.quantity,\r\n              priceAtSale: item.priceAtSale,\r\n              subtotal: item.priceAtSale * item.quantity,\r\n            })),\r\n          },\r\n        },\r\n        include: {\r\n          items: {\r\n            include: {\r\n              product: {\r\n                select: {\r\n                  id: true,\r\n                  name: true,\r\n                  imageUrl: true,\r\n                },\r\n              },\r\n            },\r\n          },\r\n          user: {\r\n            select: {\r\n              id: true,\r\n              name: true,\r\n              email: true,\r\n            },\r\n          },\r\n        },\r\n      })\r\n\r\n      // Update product stock\r\n      for (const item of data.items) {\r\n        await tx.product.update({\r\n          where: { id: item.productId },\r\n          data: {\r\n            stock: {\r\n              decrement: item.quantity,\r\n            },\r\n          },\r\n        })\r\n      }\r\n\r\n      return sale\r\n    })\r\n  }\r\n\r\n  async getSummary(startDate?: string, endDate?: string) {\r\n    const where: Prisma.SaleWhereInput = {\r\n      ...(startDate && {\r\n        createdAt: {\r\n          gte: new Date(startDate),\r\n        },\r\n      }),\r\n      ...(endDate && {\r\n        createdAt: {\r\n          ...(startDate && { gte: new Date(startDate) }),\r\n          lte: new Date(endDate),\r\n        },\r\n      }),\r\n    }\r\n\r\n    const [aggregation, paymentMethods] = await Promise.all([\r\n      prisma.sale.aggregate({\r\n        where,\r\n        _count: true,\r\n        _sum: {\r\n          total: true,\r\n          discount: true,\r\n          tax: true,\r\n        },\r\n        _avg: {\r\n          total: true,\r\n        },\r\n      }),\r\n      prisma.sale.groupBy({\r\n        by: ['paymentMethod'],\r\n        where,\r\n        _count: true,\r\n        _sum: {\r\n          total: true,\r\n        },\r\n      }),\r\n    ])\r\n\r\n    return {\r\n      totalSales: aggregation._count,\r\n      totalRevenue: aggregation._sum.total || 0,\r\n      totalDiscount: aggregation._sum.discount || 0,\r\n      totalTax: aggregation._sum.tax || 0,\r\n      averageTransaction: aggregation._avg.total || 0,\r\n      paymentMethodBreakdown: paymentMethods.map((pm) => ({\r\n        method: pm.paymentMethod,\r\n        count: pm._count,\r\n        total: pm._sum.total || 0,\r\n      })),\r\n    }\r\n  }\r\n\r\n  async getTodaySales() {\r\n    const today = new Date()\r\n    today.setHours(0, 0, 0, 0)\r\n    \r\n    return prisma.sale.findMany({\r\n      where: {\r\n        createdAt: {\r\n          gte: today,\r\n        },\r\n      },\r\n      include: {\r\n        items: {\r\n          include: {\r\n            product: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                imageUrl: true,\r\n              },\r\n            },\r\n          },\r\n        },\r\n      },\r\n      orderBy: { createdAt: 'desc' },\r\n    })\r\n  }\r\n\r\n  async getRecentSales(limit: number = 5) {\r\n    return prisma.sale.findMany({\r\n      include: {\r\n        items: {\r\n          include: {\r\n            product: {\r\n              select: {\r\n                id: true,\r\n                name: true,\r\n                imageUrl: true,\r\n              },\r\n            },\r\n          },\r\n        },\r\n        user: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n          },\r\n        },\r\n      },\r\n      orderBy: { createdAt: 'desc' },\r\n      take: limit,\r\n    })\r\n  }\r\n}\r\n\r\nexport const saleRepository = new SaleRepository()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/repository.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\r\nimport { CreateProductDTO, UpdateProductDTO, ProductQueryDTO } from './dto'\r\nimport { Prisma } from '@prisma/client'\r\n\r\nexport class ProductRepository {\r\n  async findAll(query: ProductQueryDTO) {\r\n    const {\r\n      page = 1,\r\n      limit = 10,\r\n      search,\r\n      category,\r\n      isActive,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = query\r\n\r\n    const where: Prisma.ProductWhereInput = {\r\n      ...(search && {\r\n        OR: [\r\n          { name: { contains: search } },\r\n          { description: { contains: search } },\r\n          { barcode: { contains: search } },\r\n        ],\r\n      }),\r\n      ...(category && { category }),\r\n      ...(isActive !== undefined && { isActive }),\r\n    }\r\n\r\n    const [data, total] = await Promise.all([\r\n      prisma.product.findMany({\r\n        where,\r\n        skip: (page - 1) * limit,\r\n        take: limit,\r\n        orderBy: { [sortBy]: sortOrder },\r\n      }),\r\n      prisma.product.count({ where }),\r\n    ])\r\n\r\n    return {\r\n      data,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    }\r\n  }\r\n\r\n  async findById(id: string) {\r\n    return prisma.product.findUnique({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async findByBarcode(barcode: string) {\r\n    return prisma.product.findUnique({\r\n      where: { barcode },\r\n    })\r\n  }\r\n\r\n  async findActiveProducts(search?: string) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { gt: 0 },\r\n        ...(search && {\r\n          OR: [\r\n            { name: { contains: search } },\r\n            { barcode: { contains: search } },\r\n          ],\r\n        }),\r\n      },\r\n      orderBy: { name: 'asc' },\r\n    })\r\n  }\r\n\r\n  async create(data: CreateProductDTO) {\r\n    return prisma.product.create({\r\n      data: {\r\n        name: data.name,\r\n        description: data.description,\r\n        price: data.price,\r\n        stock: data.stock,\r\n        imageUrl: data.imageUrl,\r\n        category: data.category,\r\n        barcode: data.barcode,\r\n        isActive: data.isActive ?? true,\r\n      },\r\n    })\r\n  }\r\n\r\n  async update(id: string, data: UpdateProductDTO) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data,\r\n    })\r\n  }\r\n\r\n  async updateStock(id: string, quantity: number) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data: {\r\n        stock: {\r\n          decrement: quantity,\r\n        },\r\n      },\r\n    })\r\n  }\r\n\r\n  async delete(id: string) {\r\n    return prisma.product.delete({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async getCategories() {\r\n    const products = await prisma.product.findMany({\r\n      select: { category: true },\r\n      distinct: ['category'],\r\n      where: { category: { not: null } },\r\n    })\r\n    return products.map((p) => p.category).filter(Boolean) as string[]\r\n  }\r\n\r\n  async getLowStockProducts(threshold: number = 10) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { lte: threshold },\r\n      },\r\n      orderBy: { stock: 'asc' },\r\n    })\r\n  }\r\n}\r\n\r\nexport const productRepository = new ProductRepository()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 657, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/sales/service.ts"],"sourcesContent":["import { saleRepository } from './repository'\r\nimport { productRepository } from '@/modules/products/repository'\r\nimport { CreateSaleDTO, SaleQueryDTO } from './dto'\r\n\r\nexport class SaleService {\r\n  async getSales(query: SaleQueryDTO) {\r\n    return saleRepository.findAll(query)\r\n  }\r\n\r\n  async getSaleById(id: string) {\r\n    const sale = await saleRepository.findById(id)\r\n    if (!sale) {\r\n      throw new Error('Transaksi tidak ditemukan')\r\n    }\r\n    return sale\r\n  }\r\n\r\n  async getSaleByReceiptNumber(receiptNumber: string) {\r\n    const sale = await saleRepository.findByReceiptNumber(receiptNumber)\r\n    if (!sale) {\r\n      throw new Error('Transaksi tidak ditemukan')\r\n    }\r\n    return sale\r\n  }\r\n\r\n  async createSale(data: CreateSaleDTO) {\r\n    // Validate items\r\n    for (const item of data.items) {\r\n      const product = await productRepository.findById(item.productId)\r\n      if (!product) {\r\n        throw new Error(`Produk dengan ID ${item.productId} tidak ditemukan`)\r\n      }\r\n      if (!product.isActive) {\r\n        throw new Error(`Produk ${product.name} tidak aktif`)\r\n      }\r\n      if (product.stock < item.quantity) {\r\n        throw new Error(`Stok ${product.name} tidak mencukupi`)\r\n      }\r\n    }\r\n\r\n    // Calculate totals\r\n    const subtotal = data.items.reduce(\r\n      (sum, item) => sum + item.priceAtSale * item.quantity,\r\n      0\r\n    )\r\n    const discount = data.discount || 0\r\n    const tax = data.tax || 0\r\n    const total = subtotal - discount + tax\r\n\r\n    // Validate payment\r\n    if (data.paymentAmount < total) {\r\n      throw new Error('Jumlah pembayaran kurang dari total')\r\n    }\r\n\r\n    return saleRepository.create(data)\r\n  }\r\n\r\n  async getSummary(startDate?: string, endDate?: string) {\r\n    return saleRepository.getSummary(startDate, endDate)\r\n  }\r\n\r\n  async getTodaySales() {\r\n    return saleRepository.getTodaySales()\r\n  }\r\n\r\n  async getRecentSales(limit?: number) {\r\n    return saleRepository.getRecentSales(limit)\r\n  }\r\n\r\n  async getDailySummary(date: Date = new Date()) {\r\n    const startDate = new Date(date)\r\n    startDate.setHours(0, 0, 0, 0)\r\n    \r\n    const endDate = new Date(date)\r\n    endDate.setHours(23, 59, 59, 999)\r\n\r\n    return saleRepository.getSummary(\r\n      startDate.toISOString(),\r\n      endDate.toISOString()\r\n    )\r\n  }\r\n}\r\n\r\nexport const saleService = new SaleService()\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAGO,MAAM;IACX,MAAM,SAAS,KAAmB,EAAE;QAClC,OAAO,yJAAc,CAAC,OAAO,CAAC;IAChC;IAEA,MAAM,YAAY,EAAU,EAAE;QAC5B,MAAM,OAAO,MAAM,yJAAc,CAAC,QAAQ,CAAC;QAC3C,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,uBAAuB,aAAqB,EAAE;QAClD,MAAM,OAAO,MAAM,yJAAc,CAAC,mBAAmB,CAAC;QACtD,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,WAAW,IAAmB,EAAE;QACpC,iBAAiB;QACjB,KAAK,MAAM,QAAQ,KAAK,KAAK,CAAE;YAC7B,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC,KAAK,SAAS;YAC/D,IAAI,CAAC,SAAS;gBACZ,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,KAAK,SAAS,CAAC,gBAAgB,CAAC;YACtE;YACA,IAAI,CAAC,QAAQ,QAAQ,EAAE;gBACrB,MAAM,IAAI,MAAM,CAAC,OAAO,EAAE,QAAQ,IAAI,CAAC,YAAY,CAAC;YACtD;YACA,IAAI,QAAQ,KAAK,GAAG,KAAK,QAAQ,EAAE;gBACjC,MAAM,IAAI,MAAM,CAAC,KAAK,EAAE,QAAQ,IAAI,CAAC,gBAAgB,CAAC;YACxD;QACF;QAEA,mBAAmB;QACnB,MAAM,WAAW,KAAK,KAAK,CAAC,MAAM,CAChC,CAAC,KAAK,OAAS,MAAM,KAAK,WAAW,GAAG,KAAK,QAAQ,EACrD;QAEF,MAAM,WAAW,KAAK,QAAQ,IAAI;QAClC,MAAM,MAAM,KAAK,GAAG,IAAI;QACxB,MAAM,QAAQ,WAAW,WAAW;QAEpC,mBAAmB;QACnB,IAAI,KAAK,aAAa,GAAG,OAAO;YAC9B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,yJAAc,CAAC,MAAM,CAAC;IAC/B;IAEA,MAAM,WAAW,SAAkB,EAAE,OAAgB,EAAE;QACrD,OAAO,yJAAc,CAAC,UAAU,CAAC,WAAW;IAC9C;IAEA,MAAM,gBAAgB;QACpB,OAAO,yJAAc,CAAC,aAAa;IACrC;IAEA,MAAM,eAAe,KAAc,EAAE;QACnC,OAAO,yJAAc,CAAC,cAAc,CAAC;IACvC;IAEA,MAAM,gBAAgB,OAAa,IAAI,MAAM,EAAE;QAC7C,MAAM,YAAY,IAAI,KAAK;QAC3B,UAAU,QAAQ,CAAC,GAAG,GAAG,GAAG;QAE5B,MAAM,UAAU,IAAI,KAAK;QACzB,QAAQ,QAAQ,CAAC,IAAI,IAAI,IAAI;QAE7B,OAAO,yJAAc,CAAC,UAAU,CAC9B,UAAU,WAAW,IACrB,QAAQ,WAAW;IAEvB;AACF;AAEO,MAAM,cAAc,IAAI"}},
    {"offset": {"line": 732, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 738, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 744, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/sales/index.ts"],"sourcesContent":["export { SaleRepository, saleRepository } from './repository'\r\nexport { SaleService, saleService } from './service'\r\nexport * from './dto'\r\nexport * from './entity'\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 757, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/validations.ts"],"sourcesContent":["import { z } from 'zod'\r\n\r\n// Product Schemas\r\nexport const createProductSchema = z.object({\r\n  name: z.string().min(1, 'Nama produk harus diisi'),\r\n  description: z.string().optional(),\r\n  price: z.number().min(0, 'Harga tidak boleh negatif'),\r\n  stock: z.number().int().min(0, 'Stok tidak boleh negatif'),\r\n  imageUrl: z.string().url().optional().or(z.literal('')),\r\n  category: z.string().optional(),\r\n  barcode: z.string().optional(),\r\n  isActive: z.boolean().default(true),\r\n})\r\n\r\nexport const updateProductSchema = createProductSchema.partial()\r\n\r\nexport type CreateProductInput = z.infer<typeof createProductSchema>\r\nexport type UpdateProductInput = z.infer<typeof updateProductSchema>\r\n\r\n// Sale Schemas\r\nexport const saleItemSchema = z.object({\r\n  productId: z.string().min(1, 'Product ID harus diisi'),\r\n  quantity: z.number().int().min(1, 'Quantity minimal 1'),\r\n  priceAtSale: z.number().min(0, 'Harga tidak boleh negatif'),\r\n})\r\n\r\nexport const createSaleSchema = z.object({\r\n  items: z.array(saleItemSchema).min(1, 'Minimal 1 item'),\r\n  discount: z.number().min(0).default(0),\r\n  tax: z.number().min(0).default(0),\r\n  paymentMethod: z.enum(['CASH', 'DEBIT', 'CREDIT', 'QRIS', 'TRANSFER']),\r\n  paymentAmount: z.number().min(0, 'Jumlah pembayaran harus diisi'),\r\n  notes: z.string().optional(),\r\n})\r\n\r\nexport type CreateSaleInput = z.infer<typeof createSaleSchema>\r\nexport type SaleItemInput = z.infer<typeof saleItemSchema>\r\n\r\n// User Schemas\r\nexport const createUserSchema = z.object({\r\n  name: z.string().min(1, 'Nama harus diisi'),\r\n  email: z.string().email('Email tidak valid'),\r\n  password: z.string().min(6, 'Password minimal 6 karakter'),\r\n  role: z.enum(['ADMIN', 'CASHIER']).default('CASHIER'),\r\n})\r\n\r\nexport const loginSchema = z.object({\r\n  email: z.string().email('Email tidak valid'),\r\n  password: z.string().min(1, 'Password harus diisi'),\r\n})\r\n\r\nexport type CreateUserInput = z.infer<typeof createUserSchema>\r\nexport type LoginInput = z.infer<typeof loginSchema>\r\n\r\n// Backup Schemas\r\nexport const createBackupSchema = z.object({\r\n  type: z.enum(['DAILY', 'WEEKLY', 'MONTHLY', 'MANUAL']),\r\n})\r\n\r\nexport type CreateBackupInput = z.infer<typeof createBackupSchema>\r\n\r\n// Query Schemas\r\nexport const paginationSchema = z.object({\r\n  page: z.coerce.number().int().min(1).default(1),\r\n  limit: z.coerce.number().int().min(1).max(100).default(10),\r\n  search: z.string().optional(),\r\n  sortBy: z.string().optional(),\r\n  sortOrder: z.enum(['asc', 'desc']).default('desc'),\r\n})\r\n\r\nexport const dateRangeSchema = z.object({\r\n  startDate: z.string().optional(),\r\n  endDate: z.string().optional(),\r\n})\r\n\r\nexport type PaginationInput = z.infer<typeof paginationSchema>\r\nexport type DateRangeInput = z.infer<typeof dateRangeSchema>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;AAGO,MAAM,sBAAsB,oLAAC,CAAC,MAAM,CAAC;IAC1C,MAAM,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,aAAa,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAChC,OAAO,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACzB,OAAO,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG;IAC/B,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,EAAE,CAAC,oLAAC,CAAC,OAAO,CAAC;IACnD,UAAU,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,SAAS,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,UAAU,oLAAC,CAAC,OAAO,GAAG,OAAO,CAAC;AAChC;AAEO,MAAM,sBAAsB,oBAAoB,OAAO;AAMvD,MAAM,iBAAiB,oLAAC,CAAC,MAAM,CAAC;IACrC,WAAW,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG;IAClC,aAAa,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AACjC;AAEO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,OAAO,oLAAC,CAAC,KAAK,CAAC,gBAAgB,GAAG,CAAC,GAAG;IACtC,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IACpC,KAAK,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IAC/B,eAAe,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;QAAS;QAAU;QAAQ;KAAW;IACrE,eAAe,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACjC,OAAO,oLAAC,CAAC,MAAM,GAAG,QAAQ;AAC5B;AAMO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,MAAM,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,MAAM,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAS;KAAU,EAAE,OAAO,CAAC;AAC7C;AAEO,MAAM,cAAc,oLAAC,CAAC,MAAM,CAAC;IAClC,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAMO,MAAM,qBAAqB,oLAAC,CAAC,MAAM,CAAC;IACzC,MAAM,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAS;QAAU;QAAW;KAAS;AACvD;AAKO,MAAM,mBAAmB,oLAAC,CAAC,MAAM,CAAC;IACvC,MAAM,oLAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,OAAO,CAAC;IAC7C,OAAO,oLAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,KAAK,OAAO,CAAC;IACvD,QAAQ,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,QAAQ,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,WAAW,oLAAC,CAAC,IAAI,CAAC;QAAC;QAAO;KAAO,EAAE,OAAO,CAAC;AAC7C;AAEO,MAAM,kBAAkB,oLAAC,CAAC,MAAM,CAAC;IACtC,WAAW,oLAAC,CAAC,MAAM,GAAG,QAAQ;IAC9B,SAAS,oLAAC,CAAC,MAAM,GAAG,QAAQ;AAC9B"}},
    {"offset": {"line": 908, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth'\r\nimport CredentialsProvider from 'next-auth/providers/credentials'\r\nimport { PrismaAdapter } from '@auth/prisma-adapter'\r\nimport prisma from '@/lib/prisma'\r\nimport bcrypt from 'bcryptjs'\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  adapter: PrismaAdapter(prisma) as NextAuthOptions['adapter'],\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        email: { label: 'Email', type: 'email' },\r\n        password: { label: 'Password', type: 'password' },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email || !credentials?.password) {\r\n          throw new Error('Email dan password harus diisi')\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n          where: { email: credentials.email },\r\n        })\r\n\r\n        if (!user) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        const isPasswordValid = await bcrypt.compare(\r\n          credentials.password,\r\n          user.password\r\n        )\r\n\r\n        if (!isPasswordValid) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        return {\r\n          id: user.id,\r\n          email: user.email,\r\n          name: user.name,\r\n          role: user.role,\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n        token.role = user.role\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        session.user.id = token.id as string\r\n        session.user.role = token.role as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n    error: '/login',\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n    maxAge: 24 * 60 * 60, // 24 hours\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS,IAAA,uKAAa,EAAC,iIAAM;IAC7B,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAC;gBACpC;gBAEA,IAAI,CAAC,MAAM;oBACT,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK;IACpB;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC"}},
    {"offset": {"line": 990, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/app/api/sales/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { saleService } from '@/modules/sales'\r\nimport { createSaleSchema } from '@/lib/validations'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\nimport { PaymentMethod } from '@prisma/client'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    const { searchParams } = new URL(request.url)\r\n    \r\n    const query = {\r\n      page: parseInt(searchParams.get('page') || '1'),\r\n      limit: parseInt(searchParams.get('limit') || '10'),\r\n      startDate: searchParams.get('startDate') || undefined,\r\n      endDate: searchParams.get('endDate') || undefined,\r\n      paymentMethod: searchParams.get('paymentMethod') as PaymentMethod | undefined,\r\n      sortBy: (searchParams.get('sortBy') as 'createdAt' | 'total') || 'createdAt',\r\n      sortOrder: (searchParams.get('sortOrder') as 'asc' | 'desc') || 'desc',\r\n    }\r\n\r\n    const result = await saleService.getSales(query)\r\n    return NextResponse.json(result)\r\n  } catch (error) {\r\n    console.error('Error fetching sales:', error)\r\n    return NextResponse.json(\r\n      { error: 'Gagal mengambil data penjualan' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    const body = await request.json()\r\n    const validatedData = createSaleSchema.parse(body)\r\n    \r\n    const sale = await saleService.createSale({\r\n      ...validatedData,\r\n      userId: session.user.id,\r\n    })\r\n    \r\n    return NextResponse.json(sale, { status: 201 })\r\n  } catch (error) {\r\n    console.error('Error creating sale:', error)\r\n    if (error instanceof Error) {\r\n      return NextResponse.json(\r\n        { error: error.message },\r\n        { status: 400 }\r\n      )\r\n    }\r\n    return NextResponse.json(\r\n      { error: 'Gagal membuat transaksi' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;;;;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,mIAAW;QAClD,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,MAAM,QAAQ;YACZ,MAAM,SAAS,aAAa,GAAG,CAAC,WAAW;YAC3C,OAAO,SAAS,aAAa,GAAG,CAAC,YAAY;YAC7C,WAAW,aAAa,GAAG,CAAC,gBAAgB;YAC5C,SAAS,aAAa,GAAG,CAAC,cAAc;YACxC,eAAe,aAAa,GAAG,CAAC;YAChC,QAAQ,AAAC,aAAa,GAAG,CAAC,aAAuC;YACjE,WAAW,AAAC,aAAa,GAAG,CAAC,gBAAmC;QAClE;QAEA,MAAM,SAAS,MAAM,mJAAW,CAAC,QAAQ,CAAC;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAiC,GAC1C;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,mIAAW;QAClD,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,gBAAgB,+IAAgB,CAAC,KAAK,CAAC;QAE7C,MAAM,OAAO,MAAM,mJAAW,CAAC,UAAU,CAAC;YACxC,GAAG,aAAa;YAChB,QAAQ,QAAQ,IAAI,CAAC,EAAE;QACzB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ;QAAI;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,IAAI,iBAAiB,OAAO;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,MAAM,OAAO;YAAC,GACvB;gBAAE,QAAQ;YAAI;QAElB;QACA,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA0B,GACnC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}