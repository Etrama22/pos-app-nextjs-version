{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n\r\nexport default prisma\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/backup/repository.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\r\nimport { BackupType, BackupStatus, Prisma } from '@prisma/client'\r\nimport { BackupQueryDTO } from './dto'\r\n\r\nexport class BackupRepository {\r\n  async findAll(query: BackupQueryDTO) {\r\n    const {\r\n      page = 1,\r\n      limit = 10,\r\n      type,\r\n      status,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = query\r\n\r\n    const where: Prisma.BackupLogWhereInput = {\r\n      ...(type && { type }),\r\n      ...(status && { status }),\r\n    }\r\n\r\n    const [data, total] = await Promise.all([\r\n      prisma.backupLog.findMany({\r\n        where,\r\n        skip: (page - 1) * limit,\r\n        take: limit,\r\n        orderBy: { [sortBy]: sortOrder },\r\n      }),\r\n      prisma.backupLog.count({ where }),\r\n    ])\r\n\r\n    return {\r\n      data,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    }\r\n  }\r\n\r\n  async findById(id: string) {\r\n    return prisma.backupLog.findUnique({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async findByFileName(fileName: string) {\r\n    return prisma.backupLog.findFirst({\r\n      where: { fileName },\r\n    })\r\n  }\r\n\r\n  async create(data: {\r\n    fileName: string\r\n    filePath: string\r\n    fileSize?: number\r\n    type: BackupType\r\n    status?: BackupStatus\r\n    error?: string\r\n  }) {\r\n    return prisma.backupLog.create({\r\n      data: {\r\n        fileName: data.fileName,\r\n        filePath: data.filePath,\r\n        fileSize: data.fileSize,\r\n        type: data.type,\r\n        status: data.status || 'SUCCESS',\r\n        error: data.error,\r\n      },\r\n    })\r\n  }\r\n\r\n  async updateStatus(id: string, status: BackupStatus, error?: string) {\r\n    return prisma.backupLog.update({\r\n      where: { id },\r\n      data: { status, error },\r\n    })\r\n  }\r\n\r\n  async delete(id: string) {\r\n    return prisma.backupLog.delete({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async getLatestByType(type: BackupType) {\r\n    return prisma.backupLog.findFirst({\r\n      where: { type, status: 'SUCCESS' },\r\n      orderBy: { createdAt: 'desc' },\r\n    })\r\n  }\r\n\r\n  async deleteOldBackups(type: BackupType, retentionDays: number) {\r\n    const cutoffDate = new Date()\r\n    cutoffDate.setDate(cutoffDate.getDate() - retentionDays)\r\n\r\n    return prisma.backupLog.deleteMany({\r\n      where: {\r\n        type,\r\n        createdAt: { lt: cutoffDate },\r\n      },\r\n    })\r\n  }\r\n}\r\n\r\nexport const backupRepository = new BackupRepository()\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAIO,MAAM;IACX,MAAM,QAAQ,KAAqB,EAAE;QACnC,MAAM,EACJ,OAAO,CAAC,EACR,QAAQ,EAAE,EACV,IAAI,EACJ,MAAM,EACN,SAAS,WAAW,EACpB,YAAY,MAAM,EACnB,GAAG;QAEJ,MAAM,QAAoC;YACxC,GAAI,QAAQ;gBAAE;YAAK,CAAC;YACpB,GAAI,UAAU;gBAAE;YAAO,CAAC;QAC1B;QAEA,MAAM,CAAC,MAAM,MAAM,GAAG,MAAM,QAAQ,GAAG,CAAC;YACtC,iIAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;gBACxB;gBACA,MAAM,CAAC,OAAO,CAAC,IAAI;gBACnB,MAAM;gBACN,SAAS;oBAAE,CAAC,OAAO,EAAE;gBAAU;YACjC;YACA,iIAAM,CAAC,SAAS,CAAC,KAAK,CAAC;gBAAE;YAAM;SAChC;QAED,OAAO;YACL;YACA,YAAY;gBACV;gBACA;gBACA;gBACA,YAAY,KAAK,IAAI,CAAC,QAAQ;YAChC;QACF;IACF;IAEA,MAAM,SAAS,EAAU,EAAE;QACzB,OAAO,iIAAM,CAAC,SAAS,CAAC,UAAU,CAAC;YACjC,OAAO;gBAAE;YAAG;QACd;IACF;IAEA,MAAM,eAAe,QAAgB,EAAE;QACrC,OAAO,iIAAM,CAAC,SAAS,CAAC,SAAS,CAAC;YAChC,OAAO;gBAAE;YAAS;QACpB;IACF;IAEA,MAAM,OAAO,IAOZ,EAAE;QACD,OAAO,iIAAM,CAAC,SAAS,CAAC,MAAM,CAAC;YAC7B,MAAM;gBACJ,UAAU,KAAK,QAAQ;gBACvB,UAAU,KAAK,QAAQ;gBACvB,UAAU,KAAK,QAAQ;gBACvB,MAAM,KAAK,IAAI;gBACf,QAAQ,KAAK,MAAM,IAAI;gBACvB,OAAO,KAAK,KAAK;YACnB;QACF;IACF;IAEA,MAAM,aAAa,EAAU,EAAE,MAAoB,EAAE,KAAc,EAAE;QACnE,OAAO,iIAAM,CAAC,SAAS,CAAC,MAAM,CAAC;YAC7B,OAAO;gBAAE;YAAG;YACZ,MAAM;gBAAE;gBAAQ;YAAM;QACxB;IACF;IAEA,MAAM,OAAO,EAAU,EAAE;QACvB,OAAO,iIAAM,CAAC,SAAS,CAAC,MAAM,CAAC;YAC7B,OAAO;gBAAE;YAAG;QACd;IACF;IAEA,MAAM,gBAAgB,IAAgB,EAAE;QACtC,OAAO,iIAAM,CAAC,SAAS,CAAC,SAAS,CAAC;YAChC,OAAO;gBAAE;gBAAM,QAAQ;YAAU;YACjC,SAAS;gBAAE,WAAW;YAAO;QAC/B;IACF;IAEA,MAAM,iBAAiB,IAAgB,EAAE,aAAqB,EAAE;QAC9D,MAAM,aAAa,IAAI;QACvB,WAAW,OAAO,CAAC,WAAW,OAAO,KAAK;QAE1C,OAAO,iIAAM,CAAC,SAAS,CAAC,UAAU,CAAC;YACjC,OAAO;gBACL;gBACA,WAAW;oBAAE,IAAI;gBAAW;YAC9B;QACF;IACF;AACF;AAEO,MAAM,mBAAmB,IAAI"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n\r\nexport function formatCurrency(amount: number): string {\r\n  return new Intl.NumberFormat('id-ID', {\r\n    style: 'currency',\r\n    currency: 'IDR',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(amount)\r\n}\r\n\r\nexport function formatDate(date: Date | string): string {\r\n  const d = new Date(date)\r\n  return new Intl.DateTimeFormat('id-ID', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n  }).format(d)\r\n}\r\n\r\nexport function formatDateTime(date: Date | string): string {\r\n  const d = new Date(date)\r\n  return new Intl.DateTimeFormat('id-ID', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  }).format(d)\r\n}\r\n\r\nexport function generateReceiptNumber(): string {\r\n  const date = new Date()\r\n  const year = date.getFullYear().toString().slice(-2)\r\n  const month = (date.getMonth() + 1).toString().padStart(2, '0')\r\n  const day = date.getDate().toString().padStart(2, '0')\r\n  const random = Math.random().toString(36).substring(2, 8).toUpperCase()\r\n  return `INV${year}${month}${day}-${random}`\r\n}\r\n\r\nexport function generateBackupFileName(type: string): string {\r\n  const date = new Date()\r\n  const timestamp = date.toISOString().replace(/[:.]/g, '-')\r\n  return `backup_${type}_${timestamp}.json`\r\n}\r\n\r\nexport function calculateTax(subtotal: number, taxRate: number = 0.11): number {\r\n  return Math.round(subtotal * taxRate)\r\n}\r\n\r\nexport function calculateDiscount(subtotal: number, discountPercent: number): number {\r\n  return Math.round(subtotal * (discountPercent / 100))\r\n}\r\n\r\nexport function debounce<T extends (...args: Parameters<T>) => ReturnType<T>>(\r\n  func: T,\r\n  wait: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeout: NodeJS.Timeout | null = null\r\n  return (...args: Parameters<T>) => {\r\n    if (timeout) clearTimeout(timeout)\r\n    timeout = setTimeout(() => func(...args), wait)\r\n  }\r\n}\r\n\r\nexport function truncateText(text: string, maxLength: number): string {\r\n  if (text.length <= maxLength) return text\r\n  return text.slice(0, maxLength) + '...'\r\n}\r\n\r\nexport function getInitials(name: string): string {\r\n  return name\r\n    .split(' ')\r\n    .map((n) => n[0])\r\n    .join('')\r\n    .toUpperCase()\r\n    .slice(0, 2)\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,wKAAO,EAAC,IAAA,+IAAI,EAAC;AACtB;AAEO,SAAS,eAAe,MAAc;IAC3C,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,WAAW,IAAmB;IAC5C,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;IACP,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS,eAAe,IAAmB;IAChD,MAAM,IAAI,IAAI,KAAK;IACnB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,MAAM;QACN,OAAO;QACP,KAAK;QACL,MAAM;QACN,QAAQ;IACV,GAAG,MAAM,CAAC;AACZ;AAEO,SAAS;IACd,MAAM,OAAO,IAAI;IACjB,MAAM,OAAO,KAAK,WAAW,GAAG,QAAQ,GAAG,KAAK,CAAC,CAAC;IAClD,MAAM,QAAQ,CAAC,KAAK,QAAQ,KAAK,CAAC,EAAE,QAAQ,GAAG,QAAQ,CAAC,GAAG;IAC3D,MAAM,MAAM,KAAK,OAAO,GAAG,QAAQ,GAAG,QAAQ,CAAC,GAAG;IAClD,MAAM,SAAS,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,GAAG,WAAW;IACrE,OAAO,CAAC,GAAG,EAAE,OAAO,QAAQ,IAAI,CAAC,EAAE,QAAQ;AAC7C;AAEO,SAAS,uBAAuB,IAAY;IACjD,MAAM,OAAO,IAAI;IACjB,MAAM,YAAY,KAAK,WAAW,GAAG,OAAO,CAAC,SAAS;IACtD,OAAO,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,UAAU,KAAK,CAAC;AAC3C;AAEO,SAAS,aAAa,QAAgB,EAAE,UAAkB,IAAI;IACnE,OAAO,KAAK,KAAK,CAAC,WAAW;AAC/B;AAEO,SAAS,kBAAkB,QAAgB,EAAE,eAAuB;IACzE,OAAO,KAAK,KAAK,CAAC,WAAW,CAAC,kBAAkB,GAAG;AACrD;AAEO,SAAS,SACd,IAAO,EACP,IAAY;IAEZ,IAAI,UAAiC;IACrC,OAAO,CAAC,GAAG;QACT,IAAI,SAAS,aAAa;QAC1B,UAAU,WAAW,IAAM,QAAQ,OAAO;IAC5C;AACF;AAEO,SAAS,aAAa,IAAY,EAAE,SAAiB;IAC1D,IAAI,KAAK,MAAM,IAAI,WAAW,OAAO;IACrC,OAAO,KAAK,KAAK,CAAC,GAAG,aAAa;AACpC;AAEO,SAAS,YAAY,IAAY;IACtC,OAAO,KACJ,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,IAAM,CAAC,CAAC,EAAE,EACf,IAAI,CAAC,IACL,WAAW,GACX,KAAK,CAAC,GAAG;AACd"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/config.ts"],"sourcesContent":["export const config = {\r\n  appName: process.env.APP_NAME || 'POS App',\r\n  taxRate: parseFloat(process.env.TAX_RATE || '0.11'),\r\n  currency: 'IDR',\r\n  locale: 'id-ID',\r\n  \r\n  backup: {\r\n    dailyTime: '00:00', // Midnight\r\n    weeklyDay: 0, // Sunday\r\n    monthlyDate: 1, // First day of month\r\n    retentionDays: {\r\n      daily: 7,\r\n      weekly: 30,\r\n      monthly: 365,\r\n    },\r\n  },\r\n  \r\n  pagination: {\r\n    defaultLimit: 10,\r\n    maxLimit: 100,\r\n  },\r\n  \r\n  upload: {\r\n    maxFileSize: 5 * 1024 * 1024, // 5MB\r\n    allowedTypes: ['image/jpeg', 'image/png', 'image/webp'],\r\n  },\r\n}\r\n\r\nexport const paymentMethods = [\r\n  { value: 'CASH', label: 'Tunai' },\r\n  { value: 'DEBIT', label: 'Kartu Debit' },\r\n  { value: 'CREDIT', label: 'Kartu Kredit' },\r\n  { value: 'QRIS', label: 'QRIS' },\r\n  { value: 'TRANSFER', label: 'Transfer Bank' },\r\n] as const\r\n\r\nexport const roles = [\r\n  { value: 'ADMIN', label: 'Administrator' },\r\n  { value: 'CASHIER', label: 'Kasir' },\r\n] as const\r\n\r\nexport const backupTypes = [\r\n  { value: 'DAILY', label: 'Harian' },\r\n  { value: 'WEEKLY', label: 'Mingguan' },\r\n  { value: 'MONTHLY', label: 'Bulanan' },\r\n  { value: 'MANUAL', label: 'Manual' },\r\n] as const\r\n"],"names":[],"mappings":";;;;;;;;;;AAAO,MAAM,SAAS;IACpB,SAAS,QAAQ,GAAG,CAAC,QAAQ,IAAI;IACjC,SAAS,WAAW,QAAQ,GAAG,CAAC,QAAQ,IAAI;IAC5C,UAAU;IACV,QAAQ;IAER,QAAQ;QACN,WAAW;QACX,WAAW;QACX,aAAa;QACb,eAAe;YACb,OAAO;YACP,QAAQ;YACR,SAAS;QACX;IACF;IAEA,YAAY;QACV,cAAc;QACd,UAAU;IACZ;IAEA,QAAQ;QACN,aAAa,IAAI,OAAO;QACxB,cAAc;YAAC;YAAc;YAAa;SAAa;IACzD;AACF;AAEO,MAAM,iBAAiB;IAC5B;QAAE,OAAO;QAAQ,OAAO;IAAQ;IAChC;QAAE,OAAO;QAAS,OAAO;IAAc;IACvC;QAAE,OAAO;QAAU,OAAO;IAAe;IACzC;QAAE,OAAO;QAAQ,OAAO;IAAO;IAC/B;QAAE,OAAO;QAAY,OAAO;IAAgB;CAC7C;AAEM,MAAM,QAAQ;IACnB;QAAE,OAAO;QAAS,OAAO;IAAgB;IACzC;QAAE,OAAO;QAAW,OAAO;IAAQ;CACpC;AAEM,MAAM,cAAc;IACzB;QAAE,OAAO;QAAS,OAAO;IAAS;IAClC;QAAE,OAAO;QAAU,OAAO;IAAW;IACrC;QAAE,OAAO;QAAW,OAAO;IAAU;IACrC;QAAE,OAAO;QAAU,OAAO;IAAS;CACpC"}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/backup/service.ts"],"sourcesContent":["import { backupRepository } from './repository'\r\nimport { BackupQueryDTO, CreateBackupDTO } from './dto'\r\nimport { BackupType } from '@prisma/client'\r\nimport prisma from '@/lib/prisma'\r\nimport { generateBackupFileName } from '@/lib/utils'\r\nimport { config } from '@/lib/config'\r\nimport * as fs from 'fs'\r\nimport * as path from 'path'\r\n\r\nexport class BackupService {\r\n  private backupDir = path.join(process.cwd(), 'backups')\r\n\r\n  async getBackups(query: BackupQueryDTO) {\r\n    return backupRepository.findAll(query)\r\n  }\r\n\r\n  async getBackupById(id: string) {\r\n    const backup = await backupRepository.findById(id)\r\n    if (!backup) {\r\n      throw new Error('Backup tidak ditemukan')\r\n    }\r\n    return backup\r\n  }\r\n\r\n  async createBackup(type: BackupType) {\r\n    const fileName = generateBackupFileName(type.toLowerCase())\r\n    const typeDir = path.join(this.backupDir, type.toLowerCase())\r\n    const filePath = path.join(typeDir, fileName)\r\n\r\n    // Create directory if not exists\r\n    if (!fs.existsSync(typeDir)) {\r\n      fs.mkdirSync(typeDir, { recursive: true })\r\n    }\r\n\r\n    try {\r\n      // Export all data\r\n      const [products, sales, saleItems, users, settings] = await Promise.all([\r\n        prisma.product.findMany(),\r\n        prisma.sale.findMany({\r\n          include: { items: true },\r\n        }),\r\n        prisma.saleItem.findMany(),\r\n        prisma.user.findMany({\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            email: true,\r\n            role: true,\r\n            createdAt: true,\r\n          },\r\n        }),\r\n        prisma.setting.findMany(),\r\n      ])\r\n\r\n      const backupData = {\r\n        products,\r\n        sales,\r\n        saleItems,\r\n        users,\r\n        settings,\r\n        exportedAt: new Date().toISOString(),\r\n        version: '1.0.0',\r\n      }\r\n\r\n      // Write to file\r\n      fs.writeFileSync(filePath, JSON.stringify(backupData, null, 2))\r\n\r\n      // Get file size\r\n      const stats = fs.statSync(filePath)\r\n\r\n      // Save to database\r\n      const backupLog = await backupRepository.create({\r\n        fileName,\r\n        filePath,\r\n        fileSize: stats.size,\r\n        type,\r\n        status: 'SUCCESS',\r\n      })\r\n\r\n      return backupLog\r\n    } catch (error) {\r\n      // Log failed backup\r\n      const backupLog = await backupRepository.create({\r\n        fileName,\r\n        filePath,\r\n        type,\r\n        status: 'FAILED',\r\n        error: error instanceof Error ? error.message : 'Unknown error',\r\n      })\r\n\r\n      throw error\r\n    }\r\n  }\r\n\r\n  async downloadBackup(id: string) {\r\n    const backup = await backupRepository.findById(id)\r\n    if (!backup) {\r\n      throw new Error('Backup tidak ditemukan')\r\n    }\r\n\r\n    if (!fs.existsSync(backup.filePath)) {\r\n      throw new Error('File backup tidak ditemukan')\r\n    }\r\n\r\n    const content = fs.readFileSync(backup.filePath, 'utf-8')\r\n    return {\r\n      fileName: backup.fileName,\r\n      content,\r\n    }\r\n  }\r\n\r\n  async deleteBackup(id: string) {\r\n    const backup = await backupRepository.findById(id)\r\n    if (!backup) {\r\n      throw new Error('Backup tidak ditemukan')\r\n    }\r\n\r\n    // Delete file if exists\r\n    if (fs.existsSync(backup.filePath)) {\r\n      fs.unlinkSync(backup.filePath)\r\n    }\r\n\r\n    return backupRepository.delete(id)\r\n  }\r\n\r\n  async restoreBackup(id: string) {\r\n    const backup = await backupRepository.findById(id)\r\n    if (!backup) {\r\n      throw new Error('Backup tidak ditemukan')\r\n    }\r\n\r\n    if (!fs.existsSync(backup.filePath)) {\r\n      throw new Error('File backup tidak ditemukan')\r\n    }\r\n\r\n    const content = fs.readFileSync(backup.filePath, 'utf-8')\r\n    const data = JSON.parse(content)\r\n\r\n    // Restore data in transaction\r\n    await prisma.$transaction(async (tx) => {\r\n      // Clear existing data\r\n      await tx.saleItem.deleteMany()\r\n      await tx.sale.deleteMany()\r\n      await tx.product.deleteMany()\r\n      await tx.setting.deleteMany()\r\n\r\n      // Restore products\r\n      if (data.products?.length > 0) {\r\n        for (const product of data.products) {\r\n          await tx.product.create({\r\n            data: {\r\n              id: product.id,\r\n              name: product.name,\r\n              description: product.description,\r\n              price: product.price,\r\n              stock: product.stock,\r\n              imageUrl: product.imageUrl,\r\n              category: product.category,\r\n              barcode: product.barcode,\r\n              isActive: product.isActive,\r\n              createdAt: new Date(product.createdAt),\r\n              updatedAt: new Date(product.updatedAt),\r\n            },\r\n          })\r\n        }\r\n      }\r\n\r\n      // Restore sales\r\n      if (data.sales?.length > 0) {\r\n        for (const sale of data.sales) {\r\n          await tx.sale.create({\r\n            data: {\r\n              id: sale.id,\r\n              receiptNumber: sale.receiptNumber,\r\n              subtotal: sale.subtotal,\r\n              discount: sale.discount,\r\n              tax: sale.tax,\r\n              total: sale.total,\r\n              paymentMethod: sale.paymentMethod,\r\n              paymentAmount: sale.paymentAmount,\r\n              changeAmount: sale.changeAmount,\r\n              notes: sale.notes,\r\n              userId: sale.userId,\r\n              createdAt: new Date(sale.createdAt),\r\n              updatedAt: new Date(sale.updatedAt),\r\n            },\r\n          })\r\n        }\r\n      }\r\n\r\n      // Restore sale items\r\n      if (data.saleItems?.length > 0) {\r\n        for (const item of data.saleItems) {\r\n          await tx.saleItem.create({\r\n            data: {\r\n              id: item.id,\r\n              saleId: item.saleId,\r\n              productId: item.productId,\r\n              quantity: item.quantity,\r\n              priceAtSale: item.priceAtSale,\r\n              subtotal: item.subtotal,\r\n              createdAt: new Date(item.createdAt),\r\n            },\r\n          })\r\n        }\r\n      }\r\n\r\n      // Restore settings\r\n      if (data.settings?.length > 0) {\r\n        for (const setting of data.settings) {\r\n          await tx.setting.create({\r\n            data: {\r\n              id: setting.id,\r\n              key: setting.key,\r\n              value: setting.value,\r\n              createdAt: new Date(setting.createdAt),\r\n              updatedAt: new Date(setting.updatedAt),\r\n            },\r\n          })\r\n        }\r\n      }\r\n    })\r\n\r\n    return { message: 'Restore berhasil' }\r\n  }\r\n\r\n  async cleanupOldBackups() {\r\n    const { retentionDays } = config.backup\r\n\r\n    await Promise.all([\r\n      backupRepository.deleteOldBackups('DAILY', retentionDays.daily),\r\n      backupRepository.deleteOldBackups('WEEKLY', retentionDays.weekly),\r\n      backupRepository.deleteOldBackups('MONTHLY', retentionDays.monthly),\r\n    ])\r\n  }\r\n\r\n  async getLatestBackups() {\r\n    const [daily, weekly, monthly] = await Promise.all([\r\n      backupRepository.getLatestByType('DAILY'),\r\n      backupRepository.getLatestByType('WEEKLY'),\r\n      backupRepository.getLatestByType('MONTHLY'),\r\n    ])\r\n\r\n    return { daily, weekly, monthly }\r\n  }\r\n}\r\n\r\nexport const backupService = new BackupService()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 627, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 633, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 639, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/backup/index.ts"],"sourcesContent":["export { BackupRepository, backupRepository } from './repository'\r\nexport { BackupService, backupService } from './service'\r\nexport * from './dto'\r\nexport * from './entity'\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 712, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth'\r\nimport CredentialsProvider from 'next-auth/providers/credentials'\r\nimport { PrismaAdapter } from '@auth/prisma-adapter'\r\nimport prisma from '@/lib/prisma'\r\nimport bcrypt from 'bcryptjs'\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  adapter: PrismaAdapter(prisma) as NextAuthOptions['adapter'],\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: 'Credentials',\r\n      credentials: {\r\n        email: { label: 'Email', type: 'email' },\r\n        password: { label: 'Password', type: 'password' },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email || !credentials?.password) {\r\n          throw new Error('Email dan password harus diisi')\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n          where: { email: credentials.email },\r\n        })\r\n\r\n        if (!user) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        const isPasswordValid = await bcrypt.compare(\r\n          credentials.password,\r\n          user.password\r\n        )\r\n\r\n        if (!isPasswordValid) {\r\n          throw new Error('Email atau password salah')\r\n        }\r\n\r\n        return {\r\n          id: user.id,\r\n          email: user.email,\r\n          name: user.name,\r\n          role: user.role,\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n        token.role = user.role\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        session.user.id = token.id as string\r\n        session.user.role = token.role as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: '/login',\r\n    error: '/login',\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n    maxAge: 24 * 60 * 60, // 24 hours\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS,IAAA,uKAAa,EAAC,iIAAM;IAC7B,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,OAAO,MAAM,iIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBAAE,OAAO,YAAY,KAAK;oBAAC;gBACpC;gBAEA,IAAI,CAAC,MAAM;oBACT,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;QACR,OAAO;IACT;IACA,SAAS;QACP,UAAU;QACV,QAAQ,KAAK,KAAK;IACpB;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC"}},
    {"offset": {"line": 794, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/app/api/backup/list/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { backupService } from '@/modules/backup'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\nimport { BackupType } from '@prisma/client'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const session = await getServerSession(authOptions)\r\n    if (!session || session.user.role !== 'ADMIN') {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    const { searchParams } = new URL(request.url)\r\n    \r\n    const query = {\r\n      page: parseInt(searchParams.get('page') || '1'),\r\n      limit: parseInt(searchParams.get('limit') || '10'),\r\n      type: searchParams.get('type') as BackupType | undefined,\r\n      sortBy: (searchParams.get('sortBy') as 'createdAt' | 'fileSize') || 'createdAt',\r\n      sortOrder: (searchParams.get('sortOrder') as 'asc' | 'desc') || 'desc',\r\n    }\r\n\r\n    const result = await backupService.getBackups(query)\r\n    return NextResponse.json(result)\r\n  } catch (error) {\r\n    console.error('Error fetching backup list:', error)\r\n    return NextResponse.json(\r\n      { error: 'Gagal mengambil daftar backup' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AACA;;;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2JAAgB,EAAC,mIAAW;QAClD,IAAI,CAAC,WAAW,QAAQ,IAAI,CAAC,IAAI,KAAK,SAAS;YAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAe,GACxB;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAE5C,MAAM,QAAQ;YACZ,MAAM,SAAS,aAAa,GAAG,CAAC,WAAW;YAC3C,OAAO,SAAS,aAAa,GAAG,CAAC,YAAY;YAC7C,MAAM,aAAa,GAAG,CAAC;YACvB,QAAQ,AAAC,aAAa,GAAG,CAAC,aAA0C;YACpE,WAAW,AAAC,aAAa,GAAG,CAAC,gBAAmC;QAClE;QAEA,MAAM,SAAS,MAAM,sJAAa,CAAC,UAAU,CAAC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}