{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === 'development' ? ['query', 'error', 'warn'] : ['error'],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n\r\nexport default prisma\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;AAC7E;AAEF,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/repository.ts"],"sourcesContent":["import prisma from '@/lib/prisma'\r\nimport { CreateProductDTO, UpdateProductDTO, ProductQueryDTO } from './dto'\r\nimport { Prisma } from '@prisma/client'\r\n\r\nexport class ProductRepository {\r\n  async findAll(query: ProductQueryDTO) {\r\n    const {\r\n      page = 1,\r\n      limit = 10,\r\n      search,\r\n      category,\r\n      isActive,\r\n      sortBy = 'createdAt',\r\n      sortOrder = 'desc',\r\n    } = query\r\n\r\n    const where: Prisma.ProductWhereInput = {\r\n      ...(search && {\r\n        OR: [\r\n          { name: { contains: search } },\r\n          { description: { contains: search } },\r\n          { barcode: { contains: search } },\r\n        ],\r\n      }),\r\n      ...(category && { category }),\r\n      ...(isActive !== undefined && { isActive }),\r\n    }\r\n\r\n    const [data, total] = await Promise.all([\r\n      prisma.product.findMany({\r\n        where,\r\n        skip: (page - 1) * limit,\r\n        take: limit,\r\n        orderBy: { [sortBy]: sortOrder },\r\n      }),\r\n      prisma.product.count({ where }),\r\n    ])\r\n\r\n    return {\r\n      data,\r\n      pagination: {\r\n        page,\r\n        limit,\r\n        total,\r\n        totalPages: Math.ceil(total / limit),\r\n      },\r\n    }\r\n  }\r\n\r\n  async findById(id: string) {\r\n    return prisma.product.findUnique({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async findByBarcode(barcode: string) {\r\n    return prisma.product.findUnique({\r\n      where: { barcode },\r\n    })\r\n  }\r\n\r\n  async findActiveProducts(search?: string) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { gt: 0 },\r\n        ...(search && {\r\n          OR: [\r\n            { name: { contains: search } },\r\n            { barcode: { contains: search } },\r\n          ],\r\n        }),\r\n      },\r\n      orderBy: { name: 'asc' },\r\n    })\r\n  }\r\n\r\n  async create(data: CreateProductDTO) {\r\n    return prisma.product.create({\r\n      data: {\r\n        name: data.name,\r\n        description: data.description,\r\n        price: data.price,\r\n        stock: data.stock,\r\n        imageUrl: data.imageUrl,\r\n        category: data.category,\r\n        barcode: data.barcode,\r\n        isActive: data.isActive ?? true,\r\n      },\r\n    })\r\n  }\r\n\r\n  async update(id: string, data: UpdateProductDTO) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data,\r\n    })\r\n  }\r\n\r\n  async updateStock(id: string, quantity: number) {\r\n    return prisma.product.update({\r\n      where: { id },\r\n      data: {\r\n        stock: {\r\n          decrement: quantity,\r\n        },\r\n      },\r\n    })\r\n  }\r\n\r\n  async delete(id: string) {\r\n    return prisma.product.delete({\r\n      where: { id },\r\n    })\r\n  }\r\n\r\n  async getCategories() {\r\n    const products = await prisma.product.findMany({\r\n      select: { category: true },\r\n      distinct: ['category'],\r\n      where: { category: { not: null } },\r\n    })\r\n    return products.map((p) => p.category).filter(Boolean) as string[]\r\n  }\r\n\r\n  async getLowStockProducts(threshold: number = 10) {\r\n    return prisma.product.findMany({\r\n      where: {\r\n        isActive: true,\r\n        stock: { lte: threshold },\r\n      },\r\n      orderBy: { stock: 'asc' },\r\n    })\r\n  }\r\n}\r\n\r\nexport const productRepository = new ProductRepository()\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 252, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/service.ts"],"sourcesContent":["import { productRepository } from './repository'\r\nimport { CreateProductDTO, UpdateProductDTO, ProductQueryDTO } from './dto'\r\n\r\nexport class ProductService {\r\n  async getProducts(query: ProductQueryDTO) {\r\n    return productRepository.findAll(query)\r\n  }\r\n\r\n  async getProductById(id: string) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n    return product\r\n  }\r\n\r\n  async getProductByBarcode(barcode: string) {\r\n    const product = await productRepository.findByBarcode(barcode)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n    return product\r\n  }\r\n\r\n  async getActiveProducts(search?: string) {\r\n    return productRepository.findActiveProducts(search)\r\n  }\r\n\r\n  async createProduct(data: CreateProductDTO) {\r\n    // Check if barcode already exists\r\n    if (data.barcode) {\r\n      const existingProduct = await productRepository.findByBarcode(data.barcode)\r\n      if (existingProduct) {\r\n        throw new Error('Barcode sudah digunakan')\r\n      }\r\n    }\r\n\r\n    return productRepository.create(data)\r\n  }\r\n\r\n  async updateProduct(id: string, data: UpdateProductDTO) {\r\n    // Check if product exists\r\n    const existingProduct = await productRepository.findById(id)\r\n    if (!existingProduct) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    // Check if barcode already exists (excluding current product)\r\n    if (data.barcode && data.barcode !== existingProduct.barcode) {\r\n      const productWithBarcode = await productRepository.findByBarcode(data.barcode)\r\n      if (productWithBarcode) {\r\n        throw new Error('Barcode sudah digunakan')\r\n      }\r\n    }\r\n\r\n    return productRepository.update(id, data)\r\n  }\r\n\r\n  async deleteProduct(id: string) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    return productRepository.delete(id)\r\n  }\r\n\r\n  async getCategories() {\r\n    return productRepository.getCategories()\r\n  }\r\n\r\n  async getLowStockProducts(threshold?: number) {\r\n    return productRepository.getLowStockProducts(threshold)\r\n  }\r\n\r\n  async updateStock(id: string, quantity: number) {\r\n    const product = await productRepository.findById(id)\r\n    if (!product) {\r\n      throw new Error('Produk tidak ditemukan')\r\n    }\r\n\r\n    if (product.stock < quantity) {\r\n      throw new Error('Stok tidak mencukupi')\r\n    }\r\n\r\n    return productRepository.updateStock(id, quantity)\r\n  }\r\n}\r\n\r\nexport const productService = new ProductService()\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAGO,MAAM;IACX,MAAM,YAAY,KAAsB,EAAE;QACxC,OAAO,+JAAiB,CAAC,OAAO,CAAC;IACnC;IAEA,MAAM,eAAe,EAAU,EAAE;QAC/B,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,oBAAoB,OAAe,EAAE;QACzC,MAAM,UAAU,MAAM,+JAAiB,CAAC,aAAa,CAAC;QACtD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QACA,OAAO;IACT;IAEA,MAAM,kBAAkB,MAAe,EAAE;QACvC,OAAO,+JAAiB,CAAC,kBAAkB,CAAC;IAC9C;IAEA,MAAM,cAAc,IAAsB,EAAE;QAC1C,kCAAkC;QAClC,IAAI,KAAK,OAAO,EAAE;YAChB,MAAM,kBAAkB,MAAM,+JAAiB,CAAC,aAAa,CAAC,KAAK,OAAO;YAC1E,IAAI,iBAAiB;gBACnB,MAAM,IAAI,MAAM;YAClB;QACF;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC;IAClC;IAEA,MAAM,cAAc,EAAU,EAAE,IAAsB,EAAE;QACtD,0BAA0B;QAC1B,MAAM,kBAAkB,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACzD,IAAI,CAAC,iBAAiB;YACpB,MAAM,IAAI,MAAM;QAClB;QAEA,8DAA8D;QAC9D,IAAI,KAAK,OAAO,IAAI,KAAK,OAAO,KAAK,gBAAgB,OAAO,EAAE;YAC5D,MAAM,qBAAqB,MAAM,+JAAiB,CAAC,aAAa,CAAC,KAAK,OAAO;YAC7E,IAAI,oBAAoB;gBACtB,MAAM,IAAI,MAAM;YAClB;QACF;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC,IAAI;IACtC;IAEA,MAAM,cAAc,EAAU,EAAE;QAC9B,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,+JAAiB,CAAC,MAAM,CAAC;IAClC;IAEA,MAAM,gBAAgB;QACpB,OAAO,+JAAiB,CAAC,aAAa;IACxC;IAEA,MAAM,oBAAoB,SAAkB,EAAE;QAC5C,OAAO,+JAAiB,CAAC,mBAAmB,CAAC;IAC/C;IAEA,MAAM,YAAY,EAAU,EAAE,QAAgB,EAAE;QAC9C,MAAM,UAAU,MAAM,+JAAiB,CAAC,QAAQ,CAAC;QACjD,IAAI,CAAC,SAAS;YACZ,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,QAAQ,KAAK,GAAG,UAAU;YAC5B,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,+JAAiB,CAAC,WAAW,CAAC,IAAI;IAC3C;AACF;AAEO,MAAM,iBAAiB,IAAI"}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 347, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/modules/products/index.ts"],"sourcesContent":["export { ProductRepository, productRepository } from './repository'\r\nexport { ProductService, productService } from './service'\r\nexport * from './dto'\r\nexport * from './entity'\r\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/azis.muhammad/Documents/Me/pos-app/src/app/api/products/active/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { productService } from '@/modules/products'\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const { searchParams } = new URL(request.url)\r\n    const search = searchParams.get('search') || undefined\r\n\r\n    const products = await productService.getActiveProducts(search)\r\n    return NextResponse.json(products)\r\n  } catch (error) {\r\n    console.error('Error fetching active products:', error)\r\n    return NextResponse.json(\r\n      { error: 'Gagal mengambil data produk' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;QAE7C,MAAM,WAAW,MAAM,yJAAc,CAAC,iBAAiB,CAAC;QACxD,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA8B,GACvC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}